<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.0"/>
    <title>maat.classes API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../maat.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;maat</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Plotting">Plotting</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Plotting.__init__">Plotting</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.title">title</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.low_xlim">low_xlim</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.top_xlim">top_xlim</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.low_ylim">low_ylim</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.top_ylim">top_ylim</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.add_top">add_top</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.add_low">add_low</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.offset">offset</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.vline">vline</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.vline_error">vline_error</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.hline">hline</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.hline_error">hline_error</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.figsize">figsize</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.log_xscale">log_xscale</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.show_yticks">show_yticks</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.xlabel">xlabel</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.ylabel">ylabel</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.legend">legend</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.legend_title">legend_title</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.legend_size">legend_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#Plotting.legend_loc">legend_loc</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ScaleRange">ScaleRange</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ScaleRange.__init__">ScaleRange</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScaleRange.index">index</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScaleRange.xmin">xmin</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScaleRange.xmax">xmax</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScaleRange.ymin">ymin</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScaleRange.ymax">ymax</a>
                        </li>
                        <li>
                                <a class="variable" href="#ScaleRange.zoom">zoom</a>
                        </li>
                        <li>
                                <a class="function" href="#ScaleRange.set_x">set_x</a>
                        </li>
                        <li>
                                <a class="function" href="#ScaleRange.set_y">set_y</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Spectra">Spectra</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Spectra.__init__">Spectra</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.type">type</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.comment">comment</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.save_as">save_as</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.filename">filename</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.dataframe">dataframe</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.units">units</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.units_in">units_in</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.plotting">plotting</a>
                        </li>
                        <li>
                                <a class="variable" href="#Spectra.scale_range">scale_range</a>
                        </li>
                        <li>
                                <a class="function" href="#Spectra.set_units">set_units</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Material">Material</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Material.__init__">Material</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.atoms">atoms</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.name">name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.grams">grams</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.grams_error">grams_error</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.mols">mols</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.mols_error">mols_error</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.molar_mass">molar_mass</a>
                        </li>
                        <li>
                                <a class="variable" href="#Material.cross_section">cross_section</a>
                        </li>
                        <li>
                                <a class="function" href="#Material.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#Material.print">print</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>Maat v2.3.0 documentation</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../maat.html">maat</a><wbr>.classes    </h1>

                        <div class="docstring"><p>This module contains the core classes and their functions.</p>
</div>

                        <input id="mod-classes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-classes-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">This module contains the core classes and their functions.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">.constants</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="k">class</span> <span class="nc">Plotting</span><span class="p">:</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    Stores plotting options.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">    Mainly to be used inside the `Spectra` class, but it can also be exported and used in other codes.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">    Read by `maat.plot.spectra(Spectra)`.</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>                 <span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>                 <span class="n">low_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>                 <span class="n">top_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>                 <span class="n">low_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>                 <span class="n">top_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>                 <span class="n">add_top</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>                 <span class="n">add_low</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>                 <span class="n">offset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>                 <span class="n">normalize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>                 <span class="n">vline</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>                 <span class="n">vline_error</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>                 <span class="n">hline</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>                 <span class="n">hline_error</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>                 <span class="n">figsize</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>                 <span class="n">log_xscale</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>                 <span class="n">show_yticks</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>                 <span class="n">xlabel</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>                 <span class="n">ylabel</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>                 <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>                 <span class="n">legend_title</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>                 <span class="n">legend_size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>                 <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>                 <span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Default values can be overwritten when initializing the Plotting object.&#39;&#39;&#39;</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Title of the plot. Set it to an empty string to remove the title.&#39;&#39;&#39;</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">low_xlim</span> <span class="o">=</span> <span class="n">low_xlim</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum x-value to plot.&#39;&#39;&#39;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">top_xlim</span> <span class="o">=</span> <span class="n">top_xlim</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum x-value to plot.&#39;&#39;&#39;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">low_ylim</span> <span class="o">=</span> <span class="n">low_ylim</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum y-value to plot.&#39;&#39;&#39;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">top_ylim</span> <span class="o">=</span> <span class="n">top_ylim</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum y-value to plot.&#39;&#39;&#39;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_top</span> <span class="o">=</span> <span class="n">add_top</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a space on top of the plot.&#39;&#39;&#39;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_low</span> <span class="o">=</span> <span class="n">add_low</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a space on the bottom of the plot.&#39;&#39;&#39;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        If `True`, the plots will be separated automatically.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        It can be set to a float, to equally offset the plots by a given value.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        Normalize or not the plotted spectra.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        `True` or `&#39;y&#39;` or `&#39;Y&#39;` to normalize the heights, `&#39;area&#39;` or `&#39;a&#39;` or `&#39;A&#39;` to normalize the areas.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="k">if</span> <span class="n">vline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vline</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>            <span class="n">vline</span> <span class="o">=</span> <span class="p">[</span><span class="n">vline</span><span class="p">]</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vline</span> <span class="o">=</span> <span class="n">vline</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List of vertical lines to plot.&#39;&#39;&#39;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="k">if</span> <span class="n">vline_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vline_error</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="n">vline_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">vline_error</span><span class="p">]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vline_error</span> <span class="o">=</span> <span class="n">vline_error</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        If not `None`, it will plot a shaded area of the specified width around the vertical `vlines`.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        It can be an array of the same length as `vline`, or a single value to be applied to all.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hline</span> <span class="o">=</span> <span class="n">hline</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;TODO: implement horizontal lines&#39;&#39;&#39;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hline_error</span> <span class="o">=</span> <span class="n">hline_error</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;TODO: implement error for horizontal lines&#39;&#39;&#39;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Tuple with the figure size, as in matplotlib.&#39;&#39;&#39;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_xscale</span> <span class="o">=</span> <span class="n">log_xscale</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;If true, plot the x-axis in logarithmic scale.&#39;&#39;&#39;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_yticks</span> <span class="o">=</span> <span class="n">show_yticks</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Show or not the yticks on the plot.&#39;&#39;&#39;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="n">xlabel</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        Custom label of the x-axis. If `None`, the default label will be used.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        Set to `&#39;&#39;` to remove the label of the horizontal axis.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        Label of the y-axis. If `None`, the default label will be used.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        Set to `&#39;&#39;` to remove the label of the vertical axis.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">legend</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">legend</span><span class="p">]</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        If `None`, the filenames will be used as legend. Can be a bool to show or hide the plot legend.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        It can also be an array containing the strings to display; in that case, elements set to `False` will not be displayed.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_title</span> <span class="o">=</span> <span class="n">legend_title</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Title of the legend. Defaults to `None`.&#39;&#39;&#39;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_size</span> <span class="o">=</span> <span class="n">legend_size</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Size of the legend, as in matplotlib. Defaults to `&#39;medium&#39;`.&#39;&#39;&#39;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_loc</span> <span class="o">=</span> <span class="n">legend_loc</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Location of the legend, as in matplotlib. Defaults to `&#39;best&#39;`.&#39;&#39;&#39;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="k">class</span> <span class="nc">ScaleRange</span><span class="p">:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">    The ScaleRange object is used to handle the normalization of the data inside the specified x-range,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">    to the same heigth as in the specified `index` dataset (the first one by default).</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">    Custom heights can be normalized with `ymin` and `ymax`, overriding the x-values.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">    For example, you may want to normalize with respect to the height of a given peak that overlaps with another.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">    Those peaks may have ymin values of 2 and 3, and ymax values of 50 and 60 respectively. In that case:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">    ```python</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">    spectra.scale_range = ScaleRange(index=0, ymin=[2, 3], ymax=[50, 60])</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">    ```</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">    To normalize when plotting with `maat.plot.spectra(Spectra)`, remember to set `Plotting.normalize=True`.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">    When normalizing the plot, all datasets are fitted inside the plotting window, scaling over the entire data range into view.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">    To override this behaviour and expand over the given range to fill the plot window, you can set `ScaleRange.zoom=True`.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">    This zoom setting can also be enabled without normalizing the plot, resulting in a zoom over the given range</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">    so that the `index` dataset fits the full plotting window, scaling the rest of the set accordingly.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                 <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                 <span class="n">xmin</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                 <span class="n">xmax</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>                 <span class="n">ymin</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>                 <span class="n">ymax</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                 <span class="n">zoom</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>                 <span class="p">):</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;All values can be set when initializing the ScaleRange object.&#39;&#39;&#39;</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Index of the dataframe to use as reference.&#39;&#39;&#39;</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum x-value to start normalizing the plots.&#39;&#39;&#39;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum x-value to normalize the plots.&#39;&#39;&#39;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List with minimum y-values to normalize the plots.&#39;&#39;&#39;</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List with minimum y-values to normalize the plots.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">        If `plotting.normalize=True`, the plots are normalized according to the y-values provided.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoom</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        Used when plotting with `maat.plot.spectra()`.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        If true, the data inside the range is scaled up to fit the entire plotting window.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Override with an horizontal range.&#39;&#39;&#39;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Override with a vertical range.&#39;&#39;&#39;</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="k">class</span> <span class="nc">Spectra</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">    Spectra object. Used to load and process spectral data.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">    **Use example:** to load two INS spectra CSV files from MANTID with cm$^{-1}$ as input units,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">    and plot them in meV units, normalizing their heights over the range from 20 to 50 meV:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">    ```python</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">    import maat as mt</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">    ins = mt.Spectra(</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">        type=&#39;INS&#39;,</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        filename=[&#39;example_1.csv&#39;, &#39;example_2.csv&#39;],</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        units_in=&#39;cm-1&#39;,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        units=&#39;meV&#39;,</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">        plotting=mt.Plotting(</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">            title=&#39;Calculated INS&#39;,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">            normalize=True,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">            ),</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">        scale_range=mt.ScaleRange(</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">            xmin=20,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            xmax=50,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">            ),</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">        )</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">    mt.plot.spectra(ins)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">    ```</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">    Check more use examples in the &#39;/examples/&#39; folder.</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                 <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>                 <span class="n">comment</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                 <span class="n">save_as</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                 <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                 <span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                 <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                 <span class="n">units_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>                 <span class="n">plotting</span><span class="p">:</span><span class="n">Plotting</span><span class="o">=</span><span class="n">Plotting</span><span class="p">(),</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>                 <span class="n">scale_range</span><span class="p">:</span><span class="n">ScaleRange</span><span class="o">=</span><span class="n">ScaleRange</span><span class="p">(),</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>                 <span class="p">):</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;All values can be set when initializing the Spectra object.&#39;&#39;&#39;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Type of the spectra: `&#39;INS&#39;`, `&#39;ATR&#39;`, or `&#39;RAMAN&#39;`.&#39;&#39;&#39;</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Custom comment. If `Plotting.title` is None,  Title of the plot.&#39;&#39;&#39;</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_as</span> <span class="o">=</span> <span class="n">save_as</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Filename to save the plot.&#39;&#39;&#39;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        List containing the filenames with the spectral data.</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        Loaded automatically with Pandas at initialization.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        In order for Pandas to read the files properly, note that the column lines must start by `#`.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        Any additional line that is not data must be removed or commented with `#`.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        CSV files must be formatted with the first column as the energy or energy transfer,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        and the second column with the intensity or absorbance, depending on the case. An additional third `&#39;Error&#39;` column can be used.</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        List containing the pandas dataframes with the spectral data.</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        Loaded automatically from the filenames at initialization.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Target units of the spectral data. Can be `&#39;meV&#39;` or `&#39;cm-1&#39;`.&#39;&#39;&#39;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        Input units of the spectral data, used in the input CSV files. Can be `&#39;meV&#39;` or `&#39;cm-1&#39;`.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        If the input CSV files have different units, it can also be set as a list, eg. `[&#39;meV&#39;, &#39;cm-1&#39;, &#39;cm-1&#39;]`.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotting</span> <span class="o">=</span> <span class="n">plotting</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;`Plotting` object, used to set the plotting options.&#39;&#39;&#39;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span> <span class="o">=</span> <span class="n">scale_range</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;`ScaleRange` object, used to set the normalization parameters.&#39;&#39;&#39;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_type</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_dataframe</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_units</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">units_in</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set and normalize the type of the spectra: `INS`, `ATR`, or `RAMAN`.&#39;&#39;&#39;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">spectra_keys</span><span class="p">[</span><span class="s1">&#39;INS&#39;</span><span class="p">]:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;INS&#39;</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">spectra_keys</span><span class="p">[</span><span class="s1">&#39;ATR&#39;</span><span class="p">]:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;ATR&#39;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">spectra_keys</span><span class="p">[</span><span class="s1">&#39;RAMAN&#39;</span><span class="p">]:</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;RAMAN&#39;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">_set_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">):</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the dataframes, from the given files or dataframes.&#39;&#39;&#39;</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span><span class="p">]</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataframe</span><span class="p">]</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_dataframe</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">]</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="k">def</span> <span class="nf">_read_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Read the dataframes from the files.&#39;&#39;&#39;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Sort the data by energy</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">New dataframe from </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">set_units</span><span class="p">(</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>            <span class="n">units</span><span class="p">,</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="n">units_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>            <span class="n">default_unit</span><span class="o">=</span><span class="s1">&#39;cm-1&#39;</span><span class="p">,</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>            <span class="p">):</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        Method to change between spectral units. ALWAYS use this method to do that.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        For example, to change from cm-1 to meV:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">        ```python</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        Spectra.set_units(&#39;meV&#39;, &#39;cm-1&#39;)</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        ```</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">mev</span> <span class="o">=</span> <span class="s1">&#39;meV&#39;</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="n">cm</span> <span class="o">=</span> <span class="s1">&#39;cm-1&#39;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">unit_format</span><span class="o">=</span><span class="p">{</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>                <span class="n">mev</span><span class="p">:</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;meV&#39;</span><span class="p">],</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                <span class="n">cm</span><span class="p">:</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;cm-1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;cm&#39;</span><span class="p">],</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="p">}</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="n">units_in</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">default_unit</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units_in</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit_in</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">units_in</span><span class="p">):</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>                    <span class="k">if</span> <span class="n">unit_in</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>                        <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>                        <span class="k">break</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>                <span class="n">units_in</span> <span class="o">=</span> <span class="n">units_in</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;units_in must be a list of the same length as filenames.&quot;</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units_in</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                <span class="k">if</span> <span class="n">units_in</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                    <span class="n">units_in</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>                    <span class="k">break</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="p">[</span><span class="n">units_in</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                    <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                        <span class="k">break</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;units_in must be a list of the same length as filenames.&quot;</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                    <span class="k">break</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="k">if</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="c1"># Otherwise, convert the dataframes</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">):</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Units len mismatching.&quot;</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="k">continue</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">mev</span> <span class="ow">and</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">cm_to_meV</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">cm</span> <span class="ow">and</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mev</span><span class="p">:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">meV_to_cm</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unit conversion error between &#39;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="c1"># Rename dataframe columns</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="n">E_units</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">):</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mev</span><span class="p">:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="s1">&#39;meV&#39;</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="p">:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="s1">&#39;cm-1&#39;</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;INS&#39;</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Energy transfer / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;S(Q,E)&#39;</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">]</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Energy transfer / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;S(Q,E)&#39;</span><span class="p">]</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ATR&#39;</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Wavenumber / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Absorbance&#39;</span><span class="p">]</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;RAMAN&#39;</span><span class="p">:</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Raman shift / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Counts&#39;</span><span class="p">]</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="k">class</span> <span class="nc">Material</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">    Material class.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">    Used to calculate molar masses and cross sections,</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">    and to pass data to different analysis functions such as `Maat.deuteration.impulse_approx().`</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                 <span class="n">atoms</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>                 <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>                 <span class="n">grams</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>                 <span class="n">grams_error</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>                 <span class="n">mols</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>                 <span class="n">mols_error</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>                 <span class="n">molar_mass</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>                 <span class="n">cross_section</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>                 <span class="p">):</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        All values can be set when initializing the Material object. However, it is recommended</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        to only set the atoms and the grams (and the name), and calculate the rest with `Material.set()`.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Dict of atoms in the material.&#39;&#39;&#39;</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Name of the material.&#39;&#39;&#39;</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="o">=</span> <span class="n">grams</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Mass, in grams.&#39;&#39;&#39;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">=</span> <span class="n">grams_error</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Error of the measured mass in grams. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Number of moles. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="o">=</span> <span class="n">mols_error</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Error of the number of moles. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">molar_mass</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Molar mass of the material, in mol/g. Calculated automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="o">=</span> <span class="n">cross_section</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Cross section of the material, in barns. Calculated automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>    <span class="k">def</span> <span class="nf">_set_grams_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the error in grams, based on the number of decimal places.&#39;&#39;&#39;</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="k">return</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="n">decimal_accuracy</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="c1"># Calculate the error in grams</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">decimal_accuracy</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>    <span class="k">def</span> <span class="nf">_set_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the molar mass of the material.\n</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        If `self.grams` is not `None`, the number of moles will be calculated and overwritten.&#39;&#39;&#39;</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="n">material_grams_per_mol</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="n">material_grams_per_mol</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">material_grams_per_mol</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_grams_error</span><span class="p">()</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="o">/</span> <span class="n">material_grams_per_mol</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>    
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>    <span class="k">def</span> <span class="nf">_set_cross_section</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the cross section of the material, based on the atoms dict.&#39;&#39;&#39;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>        <span class="n">total_cross_section</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>            <span class="n">total_cross_section</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">*</span> <span class="n">cross_section</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="o">=</span> <span class="n">total_cross_section</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the molar mass, cross section and errors of the material.&#39;&#39;&#39;</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_mass</span><span class="p">()</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cross_section</span><span class="p">()</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Print a summary with the material information.&#39;&#39;&#39;</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">MATERIAL&#39;</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Grams: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="si">}</span><span class="s1"> +- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span><span class="si">}</span><span class="s1"> g&#39;</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Grams: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="si">}</span><span class="s1"> g&#39;</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="si">}</span><span class="s1"> +- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span><span class="si">}</span><span class="s1"> mol&#39;</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="si">}</span><span class="s1"> mol&#39;</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Molar mass: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span><span class="si">}</span><span class="s1"> g/mol&#39;</span><span class="p">)</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross section: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span><span class="si">}</span><span class="s1"> barns&#39;</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="Plotting">
                            <input id="Plotting-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Plotting</span>:

                <label class="view-source-button" for="Plotting-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plotting"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plotting-15"><a href="#Plotting-15"><span class="linenos"> 15</span></a><span class="k">class</span> <span class="nc">Plotting</span><span class="p">:</span>
</span><span id="Plotting-16"><a href="#Plotting-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-17"><a href="#Plotting-17"><span class="linenos"> 17</span></a><span class="sd">    Stores plotting options.</span>
</span><span id="Plotting-18"><a href="#Plotting-18"><span class="linenos"> 18</span></a><span class="sd">    Mainly to be used inside the `Spectra` class, but it can also be exported and used in other codes.</span>
</span><span id="Plotting-19"><a href="#Plotting-19"><span class="linenos"> 19</span></a><span class="sd">    Read by `maat.plot.spectra(Spectra)`.</span>
</span><span id="Plotting-20"><a href="#Plotting-20"><span class="linenos"> 20</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Plotting-21"><a href="#Plotting-21"><span class="linenos"> 21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Plotting-22"><a href="#Plotting-22"><span class="linenos"> 22</span></a>                 <span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-23"><a href="#Plotting-23"><span class="linenos"> 23</span></a>                 <span class="n">low_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-24"><a href="#Plotting-24"><span class="linenos"> 24</span></a>                 <span class="n">top_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-25"><a href="#Plotting-25"><span class="linenos"> 25</span></a>                 <span class="n">low_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-26"><a href="#Plotting-26"><span class="linenos"> 26</span></a>                 <span class="n">top_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-27"><a href="#Plotting-27"><span class="linenos"> 27</span></a>                 <span class="n">add_top</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotting-28"><a href="#Plotting-28"><span class="linenos"> 28</span></a>                 <span class="n">add_low</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotting-29"><a href="#Plotting-29"><span class="linenos"> 29</span></a>                 <span class="n">offset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Plotting-30"><a href="#Plotting-30"><span class="linenos"> 30</span></a>                 <span class="n">normalize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Plotting-31"><a href="#Plotting-31"><span class="linenos"> 31</span></a>                 <span class="n">vline</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-32"><a href="#Plotting-32"><span class="linenos"> 32</span></a>                 <span class="n">vline_error</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-33"><a href="#Plotting-33"><span class="linenos"> 33</span></a>                 <span class="n">hline</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-34"><a href="#Plotting-34"><span class="linenos"> 34</span></a>                 <span class="n">hline_error</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-35"><a href="#Plotting-35"><span class="linenos"> 35</span></a>                 <span class="n">figsize</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-36"><a href="#Plotting-36"><span class="linenos"> 36</span></a>                 <span class="n">log_xscale</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Plotting-37"><a href="#Plotting-37"><span class="linenos"> 37</span></a>                 <span class="n">show_yticks</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Plotting-38"><a href="#Plotting-38"><span class="linenos"> 38</span></a>                 <span class="n">xlabel</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-39"><a href="#Plotting-39"><span class="linenos"> 39</span></a>                 <span class="n">ylabel</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-40"><a href="#Plotting-40"><span class="linenos"> 40</span></a>                 <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-41"><a href="#Plotting-41"><span class="linenos"> 41</span></a>                 <span class="n">legend_title</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting-42"><a href="#Plotting-42"><span class="linenos"> 42</span></a>                 <span class="n">legend_size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
</span><span id="Plotting-43"><a href="#Plotting-43"><span class="linenos"> 43</span></a>                 <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
</span><span id="Plotting-44"><a href="#Plotting-44"><span class="linenos"> 44</span></a>                 <span class="p">):</span>
</span><span id="Plotting-45"><a href="#Plotting-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Default values can be overwritten when initializing the Plotting object.&#39;&#39;&#39;</span>
</span><span id="Plotting-46"><a href="#Plotting-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="Plotting-47"><a href="#Plotting-47"><span class="linenos"> 47</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Title of the plot. Set it to an empty string to remove the title.&#39;&#39;&#39;</span>
</span><span id="Plotting-48"><a href="#Plotting-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">low_xlim</span> <span class="o">=</span> <span class="n">low_xlim</span>
</span><span id="Plotting-49"><a href="#Plotting-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum x-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-50"><a href="#Plotting-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">top_xlim</span> <span class="o">=</span> <span class="n">top_xlim</span>
</span><span id="Plotting-51"><a href="#Plotting-51"><span class="linenos"> 51</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum x-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-52"><a href="#Plotting-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">low_ylim</span> <span class="o">=</span> <span class="n">low_ylim</span>
</span><span id="Plotting-53"><a href="#Plotting-53"><span class="linenos"> 53</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum y-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-54"><a href="#Plotting-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">top_ylim</span> <span class="o">=</span> <span class="n">top_ylim</span>
</span><span id="Plotting-55"><a href="#Plotting-55"><span class="linenos"> 55</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum y-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-56"><a href="#Plotting-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_top</span> <span class="o">=</span> <span class="n">add_top</span>
</span><span id="Plotting-57"><a href="#Plotting-57"><span class="linenos"> 57</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a space on top of the plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-58"><a href="#Plotting-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_low</span> <span class="o">=</span> <span class="n">add_low</span>
</span><span id="Plotting-59"><a href="#Plotting-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a space on the bottom of the plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-60"><a href="#Plotting-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="Plotting-61"><a href="#Plotting-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-62"><a href="#Plotting-62"><span class="linenos"> 62</span></a><span class="sd">        If `True`, the plots will be separated automatically.</span>
</span><span id="Plotting-63"><a href="#Plotting-63"><span class="linenos"> 63</span></a><span class="sd">        It can be set to a float, to equally offset the plots by a given value.</span>
</span><span id="Plotting-64"><a href="#Plotting-64"><span class="linenos"> 64</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting-65"><a href="#Plotting-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="Plotting-66"><a href="#Plotting-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-67"><a href="#Plotting-67"><span class="linenos"> 67</span></a><span class="sd">        Normalize or not the plotted spectra.</span>
</span><span id="Plotting-68"><a href="#Plotting-68"><span class="linenos"> 68</span></a><span class="sd">        `True` or `&#39;y&#39;` or `&#39;Y&#39;` to normalize the heights, `&#39;area&#39;` or `&#39;a&#39;` or `&#39;A&#39;` to normalize the areas.</span>
</span><span id="Plotting-69"><a href="#Plotting-69"><span class="linenos"> 69</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting-70"><a href="#Plotting-70"><span class="linenos"> 70</span></a>        <span class="k">if</span> <span class="n">vline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vline</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plotting-71"><a href="#Plotting-71"><span class="linenos"> 71</span></a>            <span class="n">vline</span> <span class="o">=</span> <span class="p">[</span><span class="n">vline</span><span class="p">]</span>
</span><span id="Plotting-72"><a href="#Plotting-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vline</span> <span class="o">=</span> <span class="n">vline</span>
</span><span id="Plotting-73"><a href="#Plotting-73"><span class="linenos"> 73</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List of vertical lines to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-74"><a href="#Plotting-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="n">vline_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vline_error</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plotting-75"><a href="#Plotting-75"><span class="linenos"> 75</span></a>            <span class="n">vline_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">vline_error</span><span class="p">]</span>
</span><span id="Plotting-76"><a href="#Plotting-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vline_error</span> <span class="o">=</span> <span class="n">vline_error</span>
</span><span id="Plotting-77"><a href="#Plotting-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-78"><a href="#Plotting-78"><span class="linenos"> 78</span></a><span class="sd">        If not `None`, it will plot a shaded area of the specified width around the vertical `vlines`.</span>
</span><span id="Plotting-79"><a href="#Plotting-79"><span class="linenos"> 79</span></a><span class="sd">        It can be an array of the same length as `vline`, or a single value to be applied to all.</span>
</span><span id="Plotting-80"><a href="#Plotting-80"><span class="linenos"> 80</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting-81"><a href="#Plotting-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hline</span> <span class="o">=</span> <span class="n">hline</span>
</span><span id="Plotting-82"><a href="#Plotting-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;TODO: implement horizontal lines&#39;&#39;&#39;</span>
</span><span id="Plotting-83"><a href="#Plotting-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hline_error</span> <span class="o">=</span> <span class="n">hline_error</span>
</span><span id="Plotting-84"><a href="#Plotting-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;TODO: implement error for horizontal lines&#39;&#39;&#39;</span>
</span><span id="Plotting-85"><a href="#Plotting-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span>
</span><span id="Plotting-86"><a href="#Plotting-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Tuple with the figure size, as in matplotlib.&#39;&#39;&#39;</span>
</span><span id="Plotting-87"><a href="#Plotting-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_xscale</span> <span class="o">=</span> <span class="n">log_xscale</span>
</span><span id="Plotting-88"><a href="#Plotting-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;If true, plot the x-axis in logarithmic scale.&#39;&#39;&#39;</span>
</span><span id="Plotting-89"><a href="#Plotting-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_yticks</span> <span class="o">=</span> <span class="n">show_yticks</span>
</span><span id="Plotting-90"><a href="#Plotting-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Show or not the yticks on the plot.&#39;&#39;&#39;</span>
</span><span id="Plotting-91"><a href="#Plotting-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="n">xlabel</span>
</span><span id="Plotting-92"><a href="#Plotting-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-93"><a href="#Plotting-93"><span class="linenos"> 93</span></a><span class="sd">        Custom label of the x-axis. If `None`, the default label will be used.</span>
</span><span id="Plotting-94"><a href="#Plotting-94"><span class="linenos"> 94</span></a><span class="sd">        Set to `&#39;&#39;` to remove the label of the horizontal axis.</span>
</span><span id="Plotting-95"><a href="#Plotting-95"><span class="linenos"> 95</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting-96"><a href="#Plotting-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span>
</span><span id="Plotting-97"><a href="#Plotting-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-98"><a href="#Plotting-98"><span class="linenos"> 98</span></a><span class="sd">        Label of the y-axis. If `None`, the default label will be used.</span>
</span><span id="Plotting-99"><a href="#Plotting-99"><span class="linenos"> 99</span></a><span class="sd">        Set to `&#39;&#39;` to remove the label of the vertical axis.</span>
</span><span id="Plotting-100"><a href="#Plotting-100"><span class="linenos">100</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting-101"><a href="#Plotting-101"><span class="linenos">101</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">legend</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Plotting-102"><a href="#Plotting-102"><span class="linenos">102</span></a>            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">legend</span><span class="p">]</span>
</span><span id="Plotting-103"><a href="#Plotting-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>
</span><span id="Plotting-104"><a href="#Plotting-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting-105"><a href="#Plotting-105"><span class="linenos">105</span></a><span class="sd">        If `None`, the filenames will be used as legend. Can be a bool to show or hide the plot legend.</span>
</span><span id="Plotting-106"><a href="#Plotting-106"><span class="linenos">106</span></a><span class="sd">        It can also be an array containing the strings to display; in that case, elements set to `False` will not be displayed.</span>
</span><span id="Plotting-107"><a href="#Plotting-107"><span class="linenos">107</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting-108"><a href="#Plotting-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_title</span> <span class="o">=</span> <span class="n">legend_title</span>
</span><span id="Plotting-109"><a href="#Plotting-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Title of the legend. Defaults to `None`.&#39;&#39;&#39;</span>
</span><span id="Plotting-110"><a href="#Plotting-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_size</span> <span class="o">=</span> <span class="n">legend_size</span>
</span><span id="Plotting-111"><a href="#Plotting-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Size of the legend, as in matplotlib. Defaults to `&#39;medium&#39;`.&#39;&#39;&#39;</span>
</span><span id="Plotting-112"><a href="#Plotting-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_loc</span> <span class="o">=</span> <span class="n">legend_loc</span>
</span><span id="Plotting-113"><a href="#Plotting-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Location of the legend, as in matplotlib. Defaults to `&#39;best&#39;`.&#39;&#39;&#39;</span>
</span></pre></div>


            <div class="docstring"><p>Stores plotting options.
Mainly to be used inside the <code><a href="#Spectra">Spectra</a></code> class, but it can also be exported and used in other codes.
Read by <code><a href="plot.html#spectra">maat.plot.spectra</a>(Spectra)</code>.</p>
</div>


                            <div id="Plotting.__init__" class="classattr">
                                        <input id="Plotting.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Plotting</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">low_xlim</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">top_xlim</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">low_ylim</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">top_ylim</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">add_top</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">add_low</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">offset</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">vline</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">vline_error</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">hline</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">hline_error</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">log_xscale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">show_yticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">legend</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">legend_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">legend_size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span>,</span><span class="param">	<span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span></span>)</span>

                <label class="view-source-button" for="Plotting.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Plotting.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Plotting.__init__-21"><a href="#Plotting.__init__-21"><span class="linenos"> 21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Plotting.__init__-22"><a href="#Plotting.__init__-22"><span class="linenos"> 22</span></a>                 <span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-23"><a href="#Plotting.__init__-23"><span class="linenos"> 23</span></a>                 <span class="n">low_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-24"><a href="#Plotting.__init__-24"><span class="linenos"> 24</span></a>                 <span class="n">top_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-25"><a href="#Plotting.__init__-25"><span class="linenos"> 25</span></a>                 <span class="n">low_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-26"><a href="#Plotting.__init__-26"><span class="linenos"> 26</span></a>                 <span class="n">top_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-27"><a href="#Plotting.__init__-27"><span class="linenos"> 27</span></a>                 <span class="n">add_top</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotting.__init__-28"><a href="#Plotting.__init__-28"><span class="linenos"> 28</span></a>                 <span class="n">add_low</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Plotting.__init__-29"><a href="#Plotting.__init__-29"><span class="linenos"> 29</span></a>                 <span class="n">offset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Plotting.__init__-30"><a href="#Plotting.__init__-30"><span class="linenos"> 30</span></a>                 <span class="n">normalize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Plotting.__init__-31"><a href="#Plotting.__init__-31"><span class="linenos"> 31</span></a>                 <span class="n">vline</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-32"><a href="#Plotting.__init__-32"><span class="linenos"> 32</span></a>                 <span class="n">vline_error</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-33"><a href="#Plotting.__init__-33"><span class="linenos"> 33</span></a>                 <span class="n">hline</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-34"><a href="#Plotting.__init__-34"><span class="linenos"> 34</span></a>                 <span class="n">hline_error</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-35"><a href="#Plotting.__init__-35"><span class="linenos"> 35</span></a>                 <span class="n">figsize</span><span class="p">:</span><span class="nb">tuple</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-36"><a href="#Plotting.__init__-36"><span class="linenos"> 36</span></a>                 <span class="n">log_xscale</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Plotting.__init__-37"><a href="#Plotting.__init__-37"><span class="linenos"> 37</span></a>                 <span class="n">show_yticks</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Plotting.__init__-38"><a href="#Plotting.__init__-38"><span class="linenos"> 38</span></a>                 <span class="n">xlabel</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-39"><a href="#Plotting.__init__-39"><span class="linenos"> 39</span></a>                 <span class="n">ylabel</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-40"><a href="#Plotting.__init__-40"><span class="linenos"> 40</span></a>                 <span class="n">legend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-41"><a href="#Plotting.__init__-41"><span class="linenos"> 41</span></a>                 <span class="n">legend_title</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Plotting.__init__-42"><a href="#Plotting.__init__-42"><span class="linenos"> 42</span></a>                 <span class="n">legend_size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
</span><span id="Plotting.__init__-43"><a href="#Plotting.__init__-43"><span class="linenos"> 43</span></a>                 <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
</span><span id="Plotting.__init__-44"><a href="#Plotting.__init__-44"><span class="linenos"> 44</span></a>                 <span class="p">):</span>
</span><span id="Plotting.__init__-45"><a href="#Plotting.__init__-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Default values can be overwritten when initializing the Plotting object.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-46"><a href="#Plotting.__init__-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="Plotting.__init__-47"><a href="#Plotting.__init__-47"><span class="linenos"> 47</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Title of the plot. Set it to an empty string to remove the title.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-48"><a href="#Plotting.__init__-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">low_xlim</span> <span class="o">=</span> <span class="n">low_xlim</span>
</span><span id="Plotting.__init__-49"><a href="#Plotting.__init__-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum x-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-50"><a href="#Plotting.__init__-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">top_xlim</span> <span class="o">=</span> <span class="n">top_xlim</span>
</span><span id="Plotting.__init__-51"><a href="#Plotting.__init__-51"><span class="linenos"> 51</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum x-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-52"><a href="#Plotting.__init__-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">low_ylim</span> <span class="o">=</span> <span class="n">low_ylim</span>
</span><span id="Plotting.__init__-53"><a href="#Plotting.__init__-53"><span class="linenos"> 53</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum y-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-54"><a href="#Plotting.__init__-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">top_ylim</span> <span class="o">=</span> <span class="n">top_ylim</span>
</span><span id="Plotting.__init__-55"><a href="#Plotting.__init__-55"><span class="linenos"> 55</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum y-value to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-56"><a href="#Plotting.__init__-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_top</span> <span class="o">=</span> <span class="n">add_top</span>
</span><span id="Plotting.__init__-57"><a href="#Plotting.__init__-57"><span class="linenos"> 57</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a space on top of the plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-58"><a href="#Plotting.__init__-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">add_low</span> <span class="o">=</span> <span class="n">add_low</span>
</span><span id="Plotting.__init__-59"><a href="#Plotting.__init__-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Add a space on the bottom of the plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-60"><a href="#Plotting.__init__-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
</span><span id="Plotting.__init__-61"><a href="#Plotting.__init__-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-62"><a href="#Plotting.__init__-62"><span class="linenos"> 62</span></a><span class="sd">        If `True`, the plots will be separated automatically.</span>
</span><span id="Plotting.__init__-63"><a href="#Plotting.__init__-63"><span class="linenos"> 63</span></a><span class="sd">        It can be set to a float, to equally offset the plots by a given value.</span>
</span><span id="Plotting.__init__-64"><a href="#Plotting.__init__-64"><span class="linenos"> 64</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-65"><a href="#Plotting.__init__-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="Plotting.__init__-66"><a href="#Plotting.__init__-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-67"><a href="#Plotting.__init__-67"><span class="linenos"> 67</span></a><span class="sd">        Normalize or not the plotted spectra.</span>
</span><span id="Plotting.__init__-68"><a href="#Plotting.__init__-68"><span class="linenos"> 68</span></a><span class="sd">        `True` or `&#39;y&#39;` or `&#39;Y&#39;` to normalize the heights, `&#39;area&#39;` or `&#39;a&#39;` or `&#39;A&#39;` to normalize the areas.</span>
</span><span id="Plotting.__init__-69"><a href="#Plotting.__init__-69"><span class="linenos"> 69</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-70"><a href="#Plotting.__init__-70"><span class="linenos"> 70</span></a>        <span class="k">if</span> <span class="n">vline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vline</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plotting.__init__-71"><a href="#Plotting.__init__-71"><span class="linenos"> 71</span></a>            <span class="n">vline</span> <span class="o">=</span> <span class="p">[</span><span class="n">vline</span><span class="p">]</span>
</span><span id="Plotting.__init__-72"><a href="#Plotting.__init__-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vline</span> <span class="o">=</span> <span class="n">vline</span>
</span><span id="Plotting.__init__-73"><a href="#Plotting.__init__-73"><span class="linenos"> 73</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List of vertical lines to plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-74"><a href="#Plotting.__init__-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="n">vline_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vline_error</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Plotting.__init__-75"><a href="#Plotting.__init__-75"><span class="linenos"> 75</span></a>            <span class="n">vline_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">vline_error</span><span class="p">]</span>
</span><span id="Plotting.__init__-76"><a href="#Plotting.__init__-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vline_error</span> <span class="o">=</span> <span class="n">vline_error</span>
</span><span id="Plotting.__init__-77"><a href="#Plotting.__init__-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-78"><a href="#Plotting.__init__-78"><span class="linenos"> 78</span></a><span class="sd">        If not `None`, it will plot a shaded area of the specified width around the vertical `vlines`.</span>
</span><span id="Plotting.__init__-79"><a href="#Plotting.__init__-79"><span class="linenos"> 79</span></a><span class="sd">        It can be an array of the same length as `vline`, or a single value to be applied to all.</span>
</span><span id="Plotting.__init__-80"><a href="#Plotting.__init__-80"><span class="linenos"> 80</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-81"><a href="#Plotting.__init__-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hline</span> <span class="o">=</span> <span class="n">hline</span>
</span><span id="Plotting.__init__-82"><a href="#Plotting.__init__-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;TODO: implement horizontal lines&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-83"><a href="#Plotting.__init__-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hline_error</span> <span class="o">=</span> <span class="n">hline_error</span>
</span><span id="Plotting.__init__-84"><a href="#Plotting.__init__-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;TODO: implement error for horizontal lines&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-85"><a href="#Plotting.__init__-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">figsize</span>
</span><span id="Plotting.__init__-86"><a href="#Plotting.__init__-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Tuple with the figure size, as in matplotlib.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-87"><a href="#Plotting.__init__-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_xscale</span> <span class="o">=</span> <span class="n">log_xscale</span>
</span><span id="Plotting.__init__-88"><a href="#Plotting.__init__-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;If true, plot the x-axis in logarithmic scale.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-89"><a href="#Plotting.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_yticks</span> <span class="o">=</span> <span class="n">show_yticks</span>
</span><span id="Plotting.__init__-90"><a href="#Plotting.__init__-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Show or not the yticks on the plot.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-91"><a href="#Plotting.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span> <span class="o">=</span> <span class="n">xlabel</span>
</span><span id="Plotting.__init__-92"><a href="#Plotting.__init__-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-93"><a href="#Plotting.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        Custom label of the x-axis. If `None`, the default label will be used.</span>
</span><span id="Plotting.__init__-94"><a href="#Plotting.__init__-94"><span class="linenos"> 94</span></a><span class="sd">        Set to `&#39;&#39;` to remove the label of the horizontal axis.</span>
</span><span id="Plotting.__init__-95"><a href="#Plotting.__init__-95"><span class="linenos"> 95</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-96"><a href="#Plotting.__init__-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span> <span class="o">=</span> <span class="n">ylabel</span>
</span><span id="Plotting.__init__-97"><a href="#Plotting.__init__-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-98"><a href="#Plotting.__init__-98"><span class="linenos"> 98</span></a><span class="sd">        Label of the y-axis. If `None`, the default label will be used.</span>
</span><span id="Plotting.__init__-99"><a href="#Plotting.__init__-99"><span class="linenos"> 99</span></a><span class="sd">        Set to `&#39;&#39;` to remove the label of the vertical axis.</span>
</span><span id="Plotting.__init__-100"><a href="#Plotting.__init__-100"><span class="linenos">100</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-101"><a href="#Plotting.__init__-101"><span class="linenos">101</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">legend</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">legend</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Plotting.__init__-102"><a href="#Plotting.__init__-102"><span class="linenos">102</span></a>            <span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">legend</span><span class="p">]</span>
</span><span id="Plotting.__init__-103"><a href="#Plotting.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span>
</span><span id="Plotting.__init__-104"><a href="#Plotting.__init__-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-105"><a href="#Plotting.__init__-105"><span class="linenos">105</span></a><span class="sd">        If `None`, the filenames will be used as legend. Can be a bool to show or hide the plot legend.</span>
</span><span id="Plotting.__init__-106"><a href="#Plotting.__init__-106"><span class="linenos">106</span></a><span class="sd">        It can also be an array containing the strings to display; in that case, elements set to `False` will not be displayed.</span>
</span><span id="Plotting.__init__-107"><a href="#Plotting.__init__-107"><span class="linenos">107</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-108"><a href="#Plotting.__init__-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_title</span> <span class="o">=</span> <span class="n">legend_title</span>
</span><span id="Plotting.__init__-109"><a href="#Plotting.__init__-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Title of the legend. Defaults to `None`.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-110"><a href="#Plotting.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_size</span> <span class="o">=</span> <span class="n">legend_size</span>
</span><span id="Plotting.__init__-111"><a href="#Plotting.__init__-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Size of the legend, as in matplotlib. Defaults to `&#39;medium&#39;`.&#39;&#39;&#39;</span>
</span><span id="Plotting.__init__-112"><a href="#Plotting.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">legend_loc</span> <span class="o">=</span> <span class="n">legend_loc</span>
</span><span id="Plotting.__init__-113"><a href="#Plotting.__init__-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Location of the legend, as in matplotlib. Defaults to `&#39;best&#39;`.&#39;&#39;&#39;</span>
</span></pre></div>


            <div class="docstring"><p>Default values can be overwritten when initializing the Plotting object.</p>
</div>


                            </div>
                            <div id="Plotting.title" class="classattr">
                                <div class="attr variable">
            <span class="name">title</span>

        
    </div>
    <a class="headerlink" href="#Plotting.title"></a>
    
            <div class="docstring"><p>Title of the plot. Set it to an empty string to remove the title.</p>
</div>


                            </div>
                            <div id="Plotting.low_xlim" class="classattr">
                                <div class="attr variable">
            <span class="name">low_xlim</span>

        
    </div>
    <a class="headerlink" href="#Plotting.low_xlim"></a>
    
            <div class="docstring"><p>Minimum x-value to plot.</p>
</div>


                            </div>
                            <div id="Plotting.top_xlim" class="classattr">
                                <div class="attr variable">
            <span class="name">top_xlim</span>

        
    </div>
    <a class="headerlink" href="#Plotting.top_xlim"></a>
    
            <div class="docstring"><p>Maximum x-value to plot.</p>
</div>


                            </div>
                            <div id="Plotting.low_ylim" class="classattr">
                                <div class="attr variable">
            <span class="name">low_ylim</span>

        
    </div>
    <a class="headerlink" href="#Plotting.low_ylim"></a>
    
            <div class="docstring"><p>Minimum y-value to plot.</p>
</div>


                            </div>
                            <div id="Plotting.top_ylim" class="classattr">
                                <div class="attr variable">
            <span class="name">top_ylim</span>

        
    </div>
    <a class="headerlink" href="#Plotting.top_ylim"></a>
    
            <div class="docstring"><p>Maximum y-value to plot.</p>
</div>


                            </div>
                            <div id="Plotting.add_top" class="classattr">
                                <div class="attr variable">
            <span class="name">add_top</span>

        
    </div>
    <a class="headerlink" href="#Plotting.add_top"></a>
    
            <div class="docstring"><p>Add a space on top of the plot.</p>
</div>


                            </div>
                            <div id="Plotting.add_low" class="classattr">
                                <div class="attr variable">
            <span class="name">add_low</span>

        
    </div>
    <a class="headerlink" href="#Plotting.add_low"></a>
    
            <div class="docstring"><p>Add a space on the bottom of the plot.</p>
</div>


                            </div>
                            <div id="Plotting.offset" class="classattr">
                                <div class="attr variable">
            <span class="name">offset</span>

        
    </div>
    <a class="headerlink" href="#Plotting.offset"></a>
    
            <div class="docstring"><p>If <code>True</code>, the plots will be separated automatically.
It can be set to a float, to equally offset the plots by a given value.</p>
</div>


                            </div>
                            <div id="Plotting.normalize" class="classattr">
                                <div class="attr variable">
            <span class="name">normalize</span>

        
    </div>
    <a class="headerlink" href="#Plotting.normalize"></a>
    
            <div class="docstring"><p>Normalize or not the plotted spectra.
<code>True</code> or <code>'y'</code> or <code>'Y'</code> to normalize the heights, <code>'area'</code> or <code>'a'</code> or <code>'A'</code> to normalize the areas.</p>
</div>


                            </div>
                            <div id="Plotting.vline" class="classattr">
                                <div class="attr variable">
            <span class="name">vline</span>

        
    </div>
    <a class="headerlink" href="#Plotting.vline"></a>
    
            <div class="docstring"><p>List of vertical lines to plot.</p>
</div>


                            </div>
                            <div id="Plotting.vline_error" class="classattr">
                                <div class="attr variable">
            <span class="name">vline_error</span>

        
    </div>
    <a class="headerlink" href="#Plotting.vline_error"></a>
    
            <div class="docstring"><p>If not <code>None</code>, it will plot a shaded area of the specified width around the vertical <code>vlines</code>.
It can be an array of the same length as <code><a href="#Plotting.vline">vline</a></code>, or a single value to be applied to all.</p>
</div>


                            </div>
                            <div id="Plotting.hline" class="classattr">
                                <div class="attr variable">
            <span class="name">hline</span>

        
    </div>
    <a class="headerlink" href="#Plotting.hline"></a>
    
            <div class="docstring"><p>TODO: implement horizontal lines</p>
</div>


                            </div>
                            <div id="Plotting.hline_error" class="classattr">
                                <div class="attr variable">
            <span class="name">hline_error</span>

        
    </div>
    <a class="headerlink" href="#Plotting.hline_error"></a>
    
            <div class="docstring"><p>TODO: implement error for horizontal lines</p>
</div>


                            </div>
                            <div id="Plotting.figsize" class="classattr">
                                <div class="attr variable">
            <span class="name">figsize</span>

        
    </div>
    <a class="headerlink" href="#Plotting.figsize"></a>
    
            <div class="docstring"><p>Tuple with the figure size, as in matplotlib.</p>
</div>


                            </div>
                            <div id="Plotting.log_xscale" class="classattr">
                                <div class="attr variable">
            <span class="name">log_xscale</span>

        
    </div>
    <a class="headerlink" href="#Plotting.log_xscale"></a>
    
            <div class="docstring"><p>If true, plot the x-axis in logarithmic scale.</p>
</div>


                            </div>
                            <div id="Plotting.show_yticks" class="classattr">
                                <div class="attr variable">
            <span class="name">show_yticks</span>

        
    </div>
    <a class="headerlink" href="#Plotting.show_yticks"></a>
    
            <div class="docstring"><p>Show or not the yticks on the plot.</p>
</div>


                            </div>
                            <div id="Plotting.xlabel" class="classattr">
                                <div class="attr variable">
            <span class="name">xlabel</span>

        
    </div>
    <a class="headerlink" href="#Plotting.xlabel"></a>
    
            <div class="docstring"><p>Custom label of the x-axis. If <code>None</code>, the default label will be used.
Set to <code>''</code> to remove the label of the horizontal axis.</p>
</div>


                            </div>
                            <div id="Plotting.ylabel" class="classattr">
                                <div class="attr variable">
            <span class="name">ylabel</span>

        
    </div>
    <a class="headerlink" href="#Plotting.ylabel"></a>
    
            <div class="docstring"><p>Label of the y-axis. If <code>None</code>, the default label will be used.
Set to <code>''</code> to remove the label of the vertical axis.</p>
</div>


                            </div>
                            <div id="Plotting.legend" class="classattr">
                                <div class="attr variable">
            <span class="name">legend</span>

        
    </div>
    <a class="headerlink" href="#Plotting.legend"></a>
    
            <div class="docstring"><p>If <code>None</code>, the filenames will be used as legend. Can be a bool to show or hide the plot legend.
It can also be an array containing the strings to display; in that case, elements set to <code>False</code> will not be displayed.</p>
</div>


                            </div>
                            <div id="Plotting.legend_title" class="classattr">
                                <div class="attr variable">
            <span class="name">legend_title</span>

        
    </div>
    <a class="headerlink" href="#Plotting.legend_title"></a>
    
            <div class="docstring"><p>Title of the legend. Defaults to <code>None</code>.</p>
</div>


                            </div>
                            <div id="Plotting.legend_size" class="classattr">
                                <div class="attr variable">
            <span class="name">legend_size</span>

        
    </div>
    <a class="headerlink" href="#Plotting.legend_size"></a>
    
            <div class="docstring"><p>Size of the legend, as in matplotlib. Defaults to <code>'medium'</code>.</p>
</div>


                            </div>
                            <div id="Plotting.legend_loc" class="classattr">
                                <div class="attr variable">
            <span class="name">legend_loc</span>

        
    </div>
    <a class="headerlink" href="#Plotting.legend_loc"></a>
    
            <div class="docstring"><p>Location of the legend, as in matplotlib. Defaults to <code>'best'</code>.</p>
</div>


                            </div>
                </section>
                <section id="ScaleRange">
                            <input id="ScaleRange-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ScaleRange</span>:

                <label class="view-source-button" for="ScaleRange-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScaleRange"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScaleRange-116"><a href="#ScaleRange-116"><span class="linenos">116</span></a><span class="k">class</span> <span class="nc">ScaleRange</span><span class="p">:</span>
</span><span id="ScaleRange-117"><a href="#ScaleRange-117"><span class="linenos">117</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="ScaleRange-118"><a href="#ScaleRange-118"><span class="linenos">118</span></a><span class="sd">    The ScaleRange object is used to handle the normalization of the data inside the specified x-range,</span>
</span><span id="ScaleRange-119"><a href="#ScaleRange-119"><span class="linenos">119</span></a><span class="sd">    to the same heigth as in the specified `index` dataset (the first one by default).</span>
</span><span id="ScaleRange-120"><a href="#ScaleRange-120"><span class="linenos">120</span></a>
</span><span id="ScaleRange-121"><a href="#ScaleRange-121"><span class="linenos">121</span></a><span class="sd">    Custom heights can be normalized with `ymin` and `ymax`, overriding the x-values.</span>
</span><span id="ScaleRange-122"><a href="#ScaleRange-122"><span class="linenos">122</span></a><span class="sd">    For example, you may want to normalize with respect to the height of a given peak that overlaps with another.</span>
</span><span id="ScaleRange-123"><a href="#ScaleRange-123"><span class="linenos">123</span></a><span class="sd">    Those peaks may have ymin values of 2 and 3, and ymax values of 50 and 60 respectively. In that case:</span>
</span><span id="ScaleRange-124"><a href="#ScaleRange-124"><span class="linenos">124</span></a><span class="sd">    ```python</span>
</span><span id="ScaleRange-125"><a href="#ScaleRange-125"><span class="linenos">125</span></a><span class="sd">    spectra.scale_range = ScaleRange(index=0, ymin=[2, 3], ymax=[50, 60])</span>
</span><span id="ScaleRange-126"><a href="#ScaleRange-126"><span class="linenos">126</span></a><span class="sd">    ```</span>
</span><span id="ScaleRange-127"><a href="#ScaleRange-127"><span class="linenos">127</span></a>
</span><span id="ScaleRange-128"><a href="#ScaleRange-128"><span class="linenos">128</span></a><span class="sd">    To normalize when plotting with `maat.plot.spectra(Spectra)`, remember to set `Plotting.normalize=True`.</span>
</span><span id="ScaleRange-129"><a href="#ScaleRange-129"><span class="linenos">129</span></a><span class="sd">    When normalizing the plot, all datasets are fitted inside the plotting window, scaling over the entire data range into view.</span>
</span><span id="ScaleRange-130"><a href="#ScaleRange-130"><span class="linenos">130</span></a><span class="sd">    To override this behaviour and expand over the given range to fill the plot window, you can set `ScaleRange.zoom=True`.</span>
</span><span id="ScaleRange-131"><a href="#ScaleRange-131"><span class="linenos">131</span></a><span class="sd">    This zoom setting can also be enabled without normalizing the plot, resulting in a zoom over the given range</span>
</span><span id="ScaleRange-132"><a href="#ScaleRange-132"><span class="linenos">132</span></a><span class="sd">    so that the `index` dataset fits the full plotting window, scaling the rest of the set accordingly.</span>
</span><span id="ScaleRange-133"><a href="#ScaleRange-133"><span class="linenos">133</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="ScaleRange-134"><a href="#ScaleRange-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="ScaleRange-135"><a href="#ScaleRange-135"><span class="linenos">135</span></a>                 <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ScaleRange-136"><a href="#ScaleRange-136"><span class="linenos">136</span></a>                 <span class="n">xmin</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange-137"><a href="#ScaleRange-137"><span class="linenos">137</span></a>                 <span class="n">xmax</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange-138"><a href="#ScaleRange-138"><span class="linenos">138</span></a>                 <span class="n">ymin</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange-139"><a href="#ScaleRange-139"><span class="linenos">139</span></a>                 <span class="n">ymax</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange-140"><a href="#ScaleRange-140"><span class="linenos">140</span></a>                 <span class="n">zoom</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ScaleRange-141"><a href="#ScaleRange-141"><span class="linenos">141</span></a>                 <span class="p">):</span>
</span><span id="ScaleRange-142"><a href="#ScaleRange-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;All values can be set when initializing the ScaleRange object.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-143"><a href="#ScaleRange-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="ScaleRange-144"><a href="#ScaleRange-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Index of the dataframe to use as reference.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-145"><a href="#ScaleRange-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span>
</span><span id="ScaleRange-146"><a href="#ScaleRange-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum x-value to start normalizing the plots.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-147"><a href="#ScaleRange-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span>
</span><span id="ScaleRange-148"><a href="#ScaleRange-148"><span class="linenos">148</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum x-value to normalize the plots.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-149"><a href="#ScaleRange-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span>
</span><span id="ScaleRange-150"><a href="#ScaleRange-150"><span class="linenos">150</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List with minimum y-values to normalize the plots.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-151"><a href="#ScaleRange-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span>
</span><span id="ScaleRange-152"><a href="#ScaleRange-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List with minimum y-values to normalize the plots.</span>
</span><span id="ScaleRange-153"><a href="#ScaleRange-153"><span class="linenos">153</span></a><span class="sd">        If `plotting.normalize=True`, the plots are normalized according to the y-values provided.</span>
</span><span id="ScaleRange-154"><a href="#ScaleRange-154"><span class="linenos">154</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="ScaleRange-155"><a href="#ScaleRange-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoom</span>
</span><span id="ScaleRange-156"><a href="#ScaleRange-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="ScaleRange-157"><a href="#ScaleRange-157"><span class="linenos">157</span></a><span class="sd">        Used when plotting with `maat.plot.spectra()`.</span>
</span><span id="ScaleRange-158"><a href="#ScaleRange-158"><span class="linenos">158</span></a><span class="sd">        If true, the data inside the range is scaled up to fit the entire plotting window.</span>
</span><span id="ScaleRange-159"><a href="#ScaleRange-159"><span class="linenos">159</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="ScaleRange-160"><a href="#ScaleRange-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ScaleRange-161"><a href="#ScaleRange-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Override with an horizontal range.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-162"><a href="#ScaleRange-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span>
</span><span id="ScaleRange-163"><a href="#ScaleRange-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span>
</span><span id="ScaleRange-164"><a href="#ScaleRange-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange-165"><a href="#ScaleRange-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange-166"><a href="#ScaleRange-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="ScaleRange-167"><a href="#ScaleRange-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ScaleRange-168"><a href="#ScaleRange-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Override with a vertical range.&#39;&#39;&#39;</span>
</span><span id="ScaleRange-169"><a href="#ScaleRange-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange-170"><a href="#ScaleRange-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange-171"><a href="#ScaleRange-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span>
</span><span id="ScaleRange-172"><a href="#ScaleRange-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span>
</span><span id="ScaleRange-173"><a href="#ScaleRange-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>The ScaleRange object is used to handle the normalization of the data inside the specified x-range,
to the same heigth as in the specified <code><a href="#ScaleRange.index">index</a></code> dataset (the first one by default).</p>

<p>Custom heights can be normalized with <code><a href="#ScaleRange.ymin">ymin</a></code> and <code><a href="#ScaleRange.ymax">ymax</a></code>, overriding the x-values.
For example, you may want to normalize with respect to the height of a given peak that overlaps with another.
Those peaks may have ymin values of 2 and 3, and ymax values of 50 and 60 respectively. In that case:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">spectra</span><span class="o">.</span><span class="n">scale_range</span> <span class="o">=</span> <span class="n">ScaleRange</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ymax</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
</code></pre>
</div>

<p>To normalize when plotting with <code><a href="plot.html#spectra">maat.plot.spectra</a>(Spectra)</code>, remember to set <code><a href="#Plotting.normalize">Plotting.normalize</a>=True</code>.
When normalizing the plot, all datasets are fitted inside the plotting window, scaling over the entire data range into view.
To override this behaviour and expand over the given range to fill the plot window, you can set <code><a href="#ScaleRange.zoom">ScaleRange.zoom</a>=True</code>.
This zoom setting can also be enabled without normalizing the plot, resulting in a zoom over the given range
so that the <code><a href="#ScaleRange.index">index</a></code> dataset fits the full plotting window, scaling the rest of the set accordingly.</p>
</div>


                            <div id="ScaleRange.__init__" class="classattr">
                                        <input id="ScaleRange.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ScaleRange</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">xmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">xmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ymin</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ymax</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">zoom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="ScaleRange.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScaleRange.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScaleRange.__init__-134"><a href="#ScaleRange.__init__-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-135"><a href="#ScaleRange.__init__-135"><span class="linenos">135</span></a>                 <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-136"><a href="#ScaleRange.__init__-136"><span class="linenos">136</span></a>                 <span class="n">xmin</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-137"><a href="#ScaleRange.__init__-137"><span class="linenos">137</span></a>                 <span class="n">xmax</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-138"><a href="#ScaleRange.__init__-138"><span class="linenos">138</span></a>                 <span class="n">ymin</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-139"><a href="#ScaleRange.__init__-139"><span class="linenos">139</span></a>                 <span class="n">ymax</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-140"><a href="#ScaleRange.__init__-140"><span class="linenos">140</span></a>                 <span class="n">zoom</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ScaleRange.__init__-141"><a href="#ScaleRange.__init__-141"><span class="linenos">141</span></a>                 <span class="p">):</span>
</span><span id="ScaleRange.__init__-142"><a href="#ScaleRange.__init__-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;All values can be set when initializing the ScaleRange object.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-143"><a href="#ScaleRange.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="ScaleRange.__init__-144"><a href="#ScaleRange.__init__-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Index of the dataframe to use as reference.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-145"><a href="#ScaleRange.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span>
</span><span id="ScaleRange.__init__-146"><a href="#ScaleRange.__init__-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Minimum x-value to start normalizing the plots.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-147"><a href="#ScaleRange.__init__-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span>
</span><span id="ScaleRange.__init__-148"><a href="#ScaleRange.__init__-148"><span class="linenos">148</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Maximum x-value to normalize the plots.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-149"><a href="#ScaleRange.__init__-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span>
</span><span id="ScaleRange.__init__-150"><a href="#ScaleRange.__init__-150"><span class="linenos">150</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List with minimum y-values to normalize the plots.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-151"><a href="#ScaleRange.__init__-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span>
</span><span id="ScaleRange.__init__-152"><a href="#ScaleRange.__init__-152"><span class="linenos">152</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;List with minimum y-values to normalize the plots.</span>
</span><span id="ScaleRange.__init__-153"><a href="#ScaleRange.__init__-153"><span class="linenos">153</span></a><span class="sd">        If `plotting.normalize=True`, the plots are normalized according to the y-values provided.</span>
</span><span id="ScaleRange.__init__-154"><a href="#ScaleRange.__init__-154"><span class="linenos">154</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-155"><a href="#ScaleRange.__init__-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoom</span>
</span><span id="ScaleRange.__init__-156"><a href="#ScaleRange.__init__-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="ScaleRange.__init__-157"><a href="#ScaleRange.__init__-157"><span class="linenos">157</span></a><span class="sd">        Used when plotting with `maat.plot.spectra()`.</span>
</span><span id="ScaleRange.__init__-158"><a href="#ScaleRange.__init__-158"><span class="linenos">158</span></a><span class="sd">        If true, the data inside the range is scaled up to fit the entire plotting window.</span>
</span><span id="ScaleRange.__init__-159"><a href="#ScaleRange.__init__-159"><span class="linenos">159</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span></pre></div>


            <div class="docstring"><p>All values can be set when initializing the ScaleRange object.</p>
</div>


                            </div>
                            <div id="ScaleRange.index" class="classattr">
                                <div class="attr variable">
            <span class="name">index</span>

        
    </div>
    <a class="headerlink" href="#ScaleRange.index"></a>
    
            <div class="docstring"><p>Index of the dataframe to use as reference.</p>
</div>


                            </div>
                            <div id="ScaleRange.xmin" class="classattr">
                                <div class="attr variable">
            <span class="name">xmin</span>

        
    </div>
    <a class="headerlink" href="#ScaleRange.xmin"></a>
    
            <div class="docstring"><p>Minimum x-value to start normalizing the plots.</p>
</div>


                            </div>
                            <div id="ScaleRange.xmax" class="classattr">
                                <div class="attr variable">
            <span class="name">xmax</span>

        
    </div>
    <a class="headerlink" href="#ScaleRange.xmax"></a>
    
            <div class="docstring"><p>Maximum x-value to normalize the plots.</p>
</div>


                            </div>
                            <div id="ScaleRange.ymin" class="classattr">
                                <div class="attr variable">
            <span class="name">ymin</span>

        
    </div>
    <a class="headerlink" href="#ScaleRange.ymin"></a>
    
            <div class="docstring"><p>List with minimum y-values to normalize the plots.</p>
</div>


                            </div>
                            <div id="ScaleRange.ymax" class="classattr">
                                <div class="attr variable">
            <span class="name">ymax</span>

        
    </div>
    <a class="headerlink" href="#ScaleRange.ymax"></a>
    
            <div class="docstring"><p>List with minimum y-values to normalize the plots.
If <code>plotting.normalize=True</code>, the plots are normalized according to the y-values provided.</p>
</div>


                            </div>
                            <div id="ScaleRange.zoom" class="classattr">
                                <div class="attr variable">
            <span class="name">zoom</span>

        
    </div>
    <a class="headerlink" href="#ScaleRange.zoom"></a>
    
            <div class="docstring"><p>Used when plotting with <code><a href="plot.html#spectra">maat.plot.spectra()</a></code>.
If true, the data inside the range is scaled up to fit the entire plotting window.</p>
</div>


                            </div>
                            <div id="ScaleRange.set_x" class="classattr">
                                        <input id="ScaleRange.set_x-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_x</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">xmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">xmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ScaleRange.set_x-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScaleRange.set_x"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScaleRange.set_x-160"><a href="#ScaleRange.set_x-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ScaleRange.set_x-161"><a href="#ScaleRange.set_x-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Override with an horizontal range.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.set_x-162"><a href="#ScaleRange.set_x-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span>
</span><span id="ScaleRange.set_x-163"><a href="#ScaleRange.set_x-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span>
</span><span id="ScaleRange.set_x-164"><a href="#ScaleRange.set_x-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange.set_x-165"><a href="#ScaleRange.set_x-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange.set_x-166"><a href="#ScaleRange.set_x-166"><span class="linenos">166</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Override with an horizontal range.</p>
</div>


                            </div>
                            <div id="ScaleRange.set_y" class="classattr">
                                        <input id="ScaleRange.set_y-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_y</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ymin</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">ymax</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ScaleRange.set_y-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ScaleRange.set_y"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ScaleRange.set_y-167"><a href="#ScaleRange.set_y-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ymin</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="p">:</span><span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ScaleRange.set_y-168"><a href="#ScaleRange.set_y-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Override with a vertical range.&#39;&#39;&#39;</span>
</span><span id="ScaleRange.set_y-169"><a href="#ScaleRange.set_y-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmin</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange.set_y-170"><a href="#ScaleRange.set_y-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ScaleRange.set_y-171"><a href="#ScaleRange.set_y-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span>
</span><span id="ScaleRange.set_y-172"><a href="#ScaleRange.set_y-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span>
</span><span id="ScaleRange.set_y-173"><a href="#ScaleRange.set_y-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Override with a vertical range.</p>
</div>


                            </div>
                </section>
                <section id="Spectra">
                            <input id="Spectra-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Spectra</span>:

                <label class="view-source-button" for="Spectra-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectra"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectra-176"><a href="#Spectra-176"><span class="linenos">176</span></a><span class="k">class</span> <span class="nc">Spectra</span><span class="p">:</span>
</span><span id="Spectra-177"><a href="#Spectra-177"><span class="linenos">177</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra-178"><a href="#Spectra-178"><span class="linenos">178</span></a><span class="sd">    Spectra object. Used to load and process spectral data.</span>
</span><span id="Spectra-179"><a href="#Spectra-179"><span class="linenos">179</span></a>
</span><span id="Spectra-180"><a href="#Spectra-180"><span class="linenos">180</span></a><span class="sd">    **Use example:** to load two INS spectra CSV files from MANTID with cm$^{-1}$ as input units,</span>
</span><span id="Spectra-181"><a href="#Spectra-181"><span class="linenos">181</span></a><span class="sd">    and plot them in meV units, normalizing their heights over the range from 20 to 50 meV:</span>
</span><span id="Spectra-182"><a href="#Spectra-182"><span class="linenos">182</span></a><span class="sd">    ```python</span>
</span><span id="Spectra-183"><a href="#Spectra-183"><span class="linenos">183</span></a><span class="sd">    import maat as mt</span>
</span><span id="Spectra-184"><a href="#Spectra-184"><span class="linenos">184</span></a><span class="sd">    ins = mt.Spectra(</span>
</span><span id="Spectra-185"><a href="#Spectra-185"><span class="linenos">185</span></a><span class="sd">        type=&#39;INS&#39;,</span>
</span><span id="Spectra-186"><a href="#Spectra-186"><span class="linenos">186</span></a><span class="sd">        filename=[&#39;example_1.csv&#39;, &#39;example_2.csv&#39;],</span>
</span><span id="Spectra-187"><a href="#Spectra-187"><span class="linenos">187</span></a><span class="sd">        units_in=&#39;cm-1&#39;,</span>
</span><span id="Spectra-188"><a href="#Spectra-188"><span class="linenos">188</span></a><span class="sd">        units=&#39;meV&#39;,</span>
</span><span id="Spectra-189"><a href="#Spectra-189"><span class="linenos">189</span></a><span class="sd">        plotting=mt.Plotting(</span>
</span><span id="Spectra-190"><a href="#Spectra-190"><span class="linenos">190</span></a><span class="sd">            title=&#39;Calculated INS&#39;,</span>
</span><span id="Spectra-191"><a href="#Spectra-191"><span class="linenos">191</span></a><span class="sd">            normalize=True,</span>
</span><span id="Spectra-192"><a href="#Spectra-192"><span class="linenos">192</span></a><span class="sd">            ),</span>
</span><span id="Spectra-193"><a href="#Spectra-193"><span class="linenos">193</span></a><span class="sd">        scale_range=mt.ScaleRange(</span>
</span><span id="Spectra-194"><a href="#Spectra-194"><span class="linenos">194</span></a><span class="sd">            xmin=20,</span>
</span><span id="Spectra-195"><a href="#Spectra-195"><span class="linenos">195</span></a><span class="sd">            xmax=50,</span>
</span><span id="Spectra-196"><a href="#Spectra-196"><span class="linenos">196</span></a><span class="sd">            ),</span>
</span><span id="Spectra-197"><a href="#Spectra-197"><span class="linenos">197</span></a><span class="sd">        )</span>
</span><span id="Spectra-198"><a href="#Spectra-198"><span class="linenos">198</span></a><span class="sd">    mt.plot.spectra(ins)</span>
</span><span id="Spectra-199"><a href="#Spectra-199"><span class="linenos">199</span></a><span class="sd">    ```</span>
</span><span id="Spectra-200"><a href="#Spectra-200"><span class="linenos">200</span></a>
</span><span id="Spectra-201"><a href="#Spectra-201"><span class="linenos">201</span></a><span class="sd">    Check more use examples in the &#39;/examples/&#39; folder.</span>
</span><span id="Spectra-202"><a href="#Spectra-202"><span class="linenos">202</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Spectra-203"><a href="#Spectra-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Spectra-204"><a href="#Spectra-204"><span class="linenos">204</span></a>                 <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-205"><a href="#Spectra-205"><span class="linenos">205</span></a>                 <span class="n">comment</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-206"><a href="#Spectra-206"><span class="linenos">206</span></a>                 <span class="n">save_as</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-207"><a href="#Spectra-207"><span class="linenos">207</span></a>                 <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-208"><a href="#Spectra-208"><span class="linenos">208</span></a>                 <span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-209"><a href="#Spectra-209"><span class="linenos">209</span></a>                 <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-210"><a href="#Spectra-210"><span class="linenos">210</span></a>                 <span class="n">units_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-211"><a href="#Spectra-211"><span class="linenos">211</span></a>                 <span class="n">plotting</span><span class="p">:</span><span class="n">Plotting</span><span class="o">=</span><span class="n">Plotting</span><span class="p">(),</span>
</span><span id="Spectra-212"><a href="#Spectra-212"><span class="linenos">212</span></a>                 <span class="n">scale_range</span><span class="p">:</span><span class="n">ScaleRange</span><span class="o">=</span><span class="n">ScaleRange</span><span class="p">(),</span>
</span><span id="Spectra-213"><a href="#Spectra-213"><span class="linenos">213</span></a>                 <span class="p">):</span>
</span><span id="Spectra-214"><a href="#Spectra-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;All values can be set when initializing the Spectra object.&#39;&#39;&#39;</span>
</span><span id="Spectra-215"><a href="#Spectra-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-216"><a href="#Spectra-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Type of the spectra: `&#39;INS&#39;`, `&#39;ATR&#39;`, or `&#39;RAMAN&#39;`.&#39;&#39;&#39;</span>
</span><span id="Spectra-217"><a href="#Spectra-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
</span><span id="Spectra-218"><a href="#Spectra-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Custom comment. If `Plotting.title` is None,  Title of the plot.&#39;&#39;&#39;</span>
</span><span id="Spectra-219"><a href="#Spectra-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_as</span> <span class="o">=</span> <span class="n">save_as</span>
</span><span id="Spectra-220"><a href="#Spectra-220"><span class="linenos">220</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Filename to save the plot.&#39;&#39;&#39;</span>
</span><span id="Spectra-221"><a href="#Spectra-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-222"><a href="#Spectra-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra-223"><a href="#Spectra-223"><span class="linenos">223</span></a><span class="sd">        List containing the filenames with the spectral data.</span>
</span><span id="Spectra-224"><a href="#Spectra-224"><span class="linenos">224</span></a><span class="sd">        Loaded automatically with Pandas at initialization.</span>
</span><span id="Spectra-225"><a href="#Spectra-225"><span class="linenos">225</span></a><span class="sd">        In order for Pandas to read the files properly, note that the column lines must start by `#`.</span>
</span><span id="Spectra-226"><a href="#Spectra-226"><span class="linenos">226</span></a><span class="sd">        Any additional line that is not data must be removed or commented with `#`.</span>
</span><span id="Spectra-227"><a href="#Spectra-227"><span class="linenos">227</span></a><span class="sd">        CSV files must be formatted with the first column as the energy or energy transfer,</span>
</span><span id="Spectra-228"><a href="#Spectra-228"><span class="linenos">228</span></a><span class="sd">        and the second column with the intensity or absorbance, depending on the case. An additional third `&#39;Error&#39;` column can be used.</span>
</span><span id="Spectra-229"><a href="#Spectra-229"><span class="linenos">229</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra-230"><a href="#Spectra-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-231"><a href="#Spectra-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra-232"><a href="#Spectra-232"><span class="linenos">232</span></a><span class="sd">        List containing the pandas dataframes with the spectral data.</span>
</span><span id="Spectra-233"><a href="#Spectra-233"><span class="linenos">233</span></a><span class="sd">        Loaded automatically from the filenames at initialization.</span>
</span><span id="Spectra-234"><a href="#Spectra-234"><span class="linenos">234</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra-235"><a href="#Spectra-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-236"><a href="#Spectra-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Target units of the spectral data. Can be `&#39;meV&#39;` or `&#39;cm-1&#39;`.&#39;&#39;&#39;</span>
</span><span id="Spectra-237"><a href="#Spectra-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-238"><a href="#Spectra-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra-239"><a href="#Spectra-239"><span class="linenos">239</span></a><span class="sd">        Input units of the spectral data, used in the input CSV files. Can be `&#39;meV&#39;` or `&#39;cm-1&#39;`.</span>
</span><span id="Spectra-240"><a href="#Spectra-240"><span class="linenos">240</span></a><span class="sd">        If the input CSV files have different units, it can also be set as a list, eg. `[&#39;meV&#39;, &#39;cm-1&#39;, &#39;cm-1&#39;]`.</span>
</span><span id="Spectra-241"><a href="#Spectra-241"><span class="linenos">241</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra-242"><a href="#Spectra-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotting</span> <span class="o">=</span> <span class="n">plotting</span>
</span><span id="Spectra-243"><a href="#Spectra-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;`Plotting` object, used to set the plotting options.&#39;&#39;&#39;</span>
</span><span id="Spectra-244"><a href="#Spectra-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span> <span class="o">=</span> <span class="n">scale_range</span>
</span><span id="Spectra-245"><a href="#Spectra-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;`ScaleRange` object, used to set the normalization parameters.&#39;&#39;&#39;</span>
</span><span id="Spectra-246"><a href="#Spectra-246"><span class="linenos">246</span></a>
</span><span id="Spectra-247"><a href="#Spectra-247"><span class="linenos">247</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_type</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
</span><span id="Spectra-248"><a href="#Spectra-248"><span class="linenos">248</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_dataframe</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">)</span>
</span><span id="Spectra-249"><a href="#Spectra-249"><span class="linenos">249</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_units</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">units_in</span><span class="p">)</span>
</span><span id="Spectra-250"><a href="#Spectra-250"><span class="linenos">250</span></a>
</span><span id="Spectra-251"><a href="#Spectra-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="Spectra-252"><a href="#Spectra-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set and normalize the type of the spectra: `INS`, `ATR`, or `RAMAN`.&#39;&#39;&#39;</span>
</span><span id="Spectra-253"><a href="#Spectra-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">spectra_keys</span><span class="p">[</span><span class="s1">&#39;INS&#39;</span><span class="p">]:</span>
</span><span id="Spectra-254"><a href="#Spectra-254"><span class="linenos">254</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;INS&#39;</span>
</span><span id="Spectra-255"><a href="#Spectra-255"><span class="linenos">255</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">spectra_keys</span><span class="p">[</span><span class="s1">&#39;ATR&#39;</span><span class="p">]:</span>
</span><span id="Spectra-256"><a href="#Spectra-256"><span class="linenos">256</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;ATR&#39;</span>
</span><span id="Spectra-257"><a href="#Spectra-257"><span class="linenos">257</span></a>        <span class="k">elif</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">spectra_keys</span><span class="p">[</span><span class="s1">&#39;RAMAN&#39;</span><span class="p">]:</span>
</span><span id="Spectra-258"><a href="#Spectra-258"><span class="linenos">258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;RAMAN&#39;</span>
</span><span id="Spectra-259"><a href="#Spectra-259"><span class="linenos">259</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra-260"><a href="#Spectra-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
</span><span id="Spectra-261"><a href="#Spectra-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Spectra-262"><a href="#Spectra-262"><span class="linenos">262</span></a>
</span><span id="Spectra-263"><a href="#Spectra-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">_set_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">):</span>
</span><span id="Spectra-264"><a href="#Spectra-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the dataframes, from the given files or dataframes.&#39;&#39;&#39;</span>
</span><span id="Spectra-265"><a href="#Spectra-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Spectra-266"><a href="#Spectra-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="Spectra-267"><a href="#Spectra-267"><span class="linenos">267</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectra-268"><a href="#Spectra-268"><span class="linenos">268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span><span class="p">]</span>
</span><span id="Spectra-269"><a href="#Spectra-269"><span class="linenos">269</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra-270"><a href="#Spectra-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Spectra-271"><a href="#Spectra-271"><span class="linenos">271</span></a>
</span><span id="Spectra-272"><a href="#Spectra-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Spectra-273"><a href="#Spectra-273"><span class="linenos">273</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataframe</span><span class="p">]</span>
</span><span id="Spectra-274"><a href="#Spectra-274"><span class="linenos">274</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Spectra-275"><a href="#Spectra-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">dataframe</span>
</span><span id="Spectra-276"><a href="#Spectra-276"><span class="linenos">276</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra-277"><a href="#Spectra-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_dataframe</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">]</span>
</span><span id="Spectra-278"><a href="#Spectra-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Spectra-279"><a href="#Spectra-279"><span class="linenos">279</span></a>
</span><span id="Spectra-280"><a href="#Spectra-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">_read_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="Spectra-281"><a href="#Spectra-281"><span class="linenos">281</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Read the dataframes from the files.&#39;&#39;&#39;</span>
</span><span id="Spectra-282"><a href="#Spectra-282"><span class="linenos">282</span></a>        <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</span><span id="Spectra-283"><a href="#Spectra-283"><span class="linenos">283</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra-284"><a href="#Spectra-284"><span class="linenos">284</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
</span><span id="Spectra-285"><a href="#Spectra-285"><span class="linenos">285</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Sort the data by energy</span>
</span><span id="Spectra-286"><a href="#Spectra-286"><span class="linenos">286</span></a>
</span><span id="Spectra-287"><a href="#Spectra-287"><span class="linenos">287</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">New dataframe from </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectra-288"><a href="#Spectra-288"><span class="linenos">288</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Spectra-289"><a href="#Spectra-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="Spectra-290"><a href="#Spectra-290"><span class="linenos">290</span></a>
</span><span id="Spectra-291"><a href="#Spectra-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">set_units</span><span class="p">(</span>
</span><span id="Spectra-292"><a href="#Spectra-292"><span class="linenos">292</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="Spectra-293"><a href="#Spectra-293"><span class="linenos">293</span></a>            <span class="n">units</span><span class="p">,</span>
</span><span id="Spectra-294"><a href="#Spectra-294"><span class="linenos">294</span></a>            <span class="n">units_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra-295"><a href="#Spectra-295"><span class="linenos">295</span></a>            <span class="n">default_unit</span><span class="o">=</span><span class="s1">&#39;cm-1&#39;</span><span class="p">,</span>
</span><span id="Spectra-296"><a href="#Spectra-296"><span class="linenos">296</span></a>            <span class="p">):</span>
</span><span id="Spectra-297"><a href="#Spectra-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra-298"><a href="#Spectra-298"><span class="linenos">298</span></a><span class="sd">        Method to change between spectral units. ALWAYS use this method to do that.</span>
</span><span id="Spectra-299"><a href="#Spectra-299"><span class="linenos">299</span></a><span class="sd">        For example, to change from cm-1 to meV:</span>
</span><span id="Spectra-300"><a href="#Spectra-300"><span class="linenos">300</span></a><span class="sd">        ```python</span>
</span><span id="Spectra-301"><a href="#Spectra-301"><span class="linenos">301</span></a><span class="sd">        Spectra.set_units(&#39;meV&#39;, &#39;cm-1&#39;)</span>
</span><span id="Spectra-302"><a href="#Spectra-302"><span class="linenos">302</span></a><span class="sd">        ```</span>
</span><span id="Spectra-303"><a href="#Spectra-303"><span class="linenos">303</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra-304"><a href="#Spectra-304"><span class="linenos">304</span></a>        <span class="n">mev</span> <span class="o">=</span> <span class="s1">&#39;meV&#39;</span>
</span><span id="Spectra-305"><a href="#Spectra-305"><span class="linenos">305</span></a>        <span class="n">cm</span> <span class="o">=</span> <span class="s1">&#39;cm-1&#39;</span>
</span><span id="Spectra-306"><a href="#Spectra-306"><span class="linenos">306</span></a>        <span class="n">unit_format</span><span class="o">=</span><span class="p">{</span>
</span><span id="Spectra-307"><a href="#Spectra-307"><span class="linenos">307</span></a>                <span class="n">mev</span><span class="p">:</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;meV&#39;</span><span class="p">],</span>
</span><span id="Spectra-308"><a href="#Spectra-308"><span class="linenos">308</span></a>                <span class="n">cm</span><span class="p">:</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;cm-1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;cm&#39;</span><span class="p">],</span>
</span><span id="Spectra-309"><a href="#Spectra-309"><span class="linenos">309</span></a>            <span class="p">}</span>
</span><span id="Spectra-310"><a href="#Spectra-310"><span class="linenos">310</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra-311"><a href="#Spectra-311"><span class="linenos">311</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
</span><span id="Spectra-312"><a href="#Spectra-312"><span class="linenos">312</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
</span><span id="Spectra-313"><a href="#Spectra-313"><span class="linenos">313</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra-314"><a href="#Spectra-314"><span class="linenos">314</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="n">units_in</span>
</span><span id="Spectra-315"><a href="#Spectra-315"><span class="linenos">315</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
</span><span id="Spectra-316"><a href="#Spectra-316"><span class="linenos">316</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra-317"><a href="#Spectra-317"><span class="linenos">317</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-318"><a href="#Spectra-318"><span class="linenos">318</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">default_unit</span>
</span><span id="Spectra-319"><a href="#Spectra-319"><span class="linenos">319</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra-320"><a href="#Spectra-320"><span class="linenos">320</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-321"><a href="#Spectra-321"><span class="linenos">321</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span>
</span><span id="Spectra-322"><a href="#Spectra-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units_in</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Spectra-323"><a href="#Spectra-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit_in</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">units_in</span><span class="p">):</span>
</span><span id="Spectra-324"><a href="#Spectra-324"><span class="linenos">324</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra-325"><a href="#Spectra-325"><span class="linenos">325</span></a>                    <span class="k">if</span> <span class="n">unit_in</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra-326"><a href="#Spectra-326"><span class="linenos">326</span></a>                        <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra-327"><a href="#Spectra-327"><span class="linenos">327</span></a>                        <span class="k">break</span>
</span><span id="Spectra-328"><a href="#Spectra-328"><span class="linenos">328</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectra-329"><a href="#Spectra-329"><span class="linenos">329</span></a>                <span class="n">units_in</span> <span class="o">=</span> <span class="n">units_in</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra-330"><a href="#Spectra-330"><span class="linenos">330</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
</span><span id="Spectra-331"><a href="#Spectra-331"><span class="linenos">331</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;units_in must be a list of the same length as filenames.&quot;</span><span class="p">)</span>
</span><span id="Spectra-332"><a href="#Spectra-332"><span class="linenos">332</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units_in</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectra-333"><a href="#Spectra-333"><span class="linenos">333</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra-334"><a href="#Spectra-334"><span class="linenos">334</span></a>                <span class="k">if</span> <span class="n">units_in</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra-335"><a href="#Spectra-335"><span class="linenos">335</span></a>                    <span class="n">units_in</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra-336"><a href="#Spectra-336"><span class="linenos">336</span></a>                    <span class="k">break</span>
</span><span id="Spectra-337"><a href="#Spectra-337"><span class="linenos">337</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="p">[</span><span class="n">units_in</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra-338"><a href="#Spectra-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Spectra-339"><a href="#Spectra-339"><span class="linenos">339</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
</span><span id="Spectra-340"><a href="#Spectra-340"><span class="linenos">340</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra-341"><a href="#Spectra-341"><span class="linenos">341</span></a>                    <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra-342"><a href="#Spectra-342"><span class="linenos">342</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra-343"><a href="#Spectra-343"><span class="linenos">343</span></a>                        <span class="k">break</span>
</span><span id="Spectra-344"><a href="#Spectra-344"><span class="linenos">344</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectra-345"><a href="#Spectra-345"><span class="linenos">345</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra-346"><a href="#Spectra-346"><span class="linenos">346</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
</span><span id="Spectra-347"><a href="#Spectra-347"><span class="linenos">347</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;units_in must be a list of the same length as filenames.&quot;</span><span class="p">)</span>
</span><span id="Spectra-348"><a href="#Spectra-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectra-349"><a href="#Spectra-349"><span class="linenos">349</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra-350"><a href="#Spectra-350"><span class="linenos">350</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra-351"><a href="#Spectra-351"><span class="linenos">351</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra-352"><a href="#Spectra-352"><span class="linenos">352</span></a>                    <span class="k">break</span>
</span><span id="Spectra-353"><a href="#Spectra-353"><span class="linenos">353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra-354"><a href="#Spectra-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra-355"><a href="#Spectra-355"><span class="linenos">355</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Spectra-356"><a href="#Spectra-356"><span class="linenos">356</span></a>        <span class="c1"># Otherwise, convert the dataframes</span>
</span><span id="Spectra-357"><a href="#Spectra-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">):</span>
</span><span id="Spectra-358"><a href="#Spectra-358"><span class="linenos">358</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Units len mismatching.&quot;</span><span class="p">)</span>
</span><span id="Spectra-359"><a href="#Spectra-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
</span><span id="Spectra-360"><a href="#Spectra-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="Spectra-361"><a href="#Spectra-361"><span class="linenos">361</span></a>                <span class="k">continue</span>
</span><span id="Spectra-362"><a href="#Spectra-362"><span class="linenos">362</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">mev</span> <span class="ow">and</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="p">:</span>
</span><span id="Spectra-363"><a href="#Spectra-363"><span class="linenos">363</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">cm_to_meV</span>
</span><span id="Spectra-364"><a href="#Spectra-364"><span class="linenos">364</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">cm</span> <span class="ow">and</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mev</span><span class="p">:</span>
</span><span id="Spectra-365"><a href="#Spectra-365"><span class="linenos">365</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">meV_to_cm</span>
</span><span id="Spectra-366"><a href="#Spectra-366"><span class="linenos">366</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra-367"><a href="#Spectra-367"><span class="linenos">367</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unit conversion error between &#39;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="Spectra-368"><a href="#Spectra-368"><span class="linenos">368</span></a>        <span class="c1"># Rename dataframe columns</span>
</span><span id="Spectra-369"><a href="#Spectra-369"><span class="linenos">369</span></a>        <span class="n">E_units</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra-370"><a href="#Spectra-370"><span class="linenos">370</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">):</span>
</span><span id="Spectra-371"><a href="#Spectra-371"><span class="linenos">371</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mev</span><span class="p">:</span>
</span><span id="Spectra-372"><a href="#Spectra-372"><span class="linenos">372</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="s1">&#39;meV&#39;</span>
</span><span id="Spectra-373"><a href="#Spectra-373"><span class="linenos">373</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="p">:</span>
</span><span id="Spectra-374"><a href="#Spectra-374"><span class="linenos">374</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="s1">&#39;cm-1&#39;</span>
</span><span id="Spectra-375"><a href="#Spectra-375"><span class="linenos">375</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra-376"><a href="#Spectra-376"><span class="linenos">376</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Spectra-377"><a href="#Spectra-377"><span class="linenos">377</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;INS&#39;</span><span class="p">:</span>
</span><span id="Spectra-378"><a href="#Spectra-378"><span class="linenos">378</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Spectra-379"><a href="#Spectra-379"><span class="linenos">379</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Energy transfer / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;S(Q,E)&#39;</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">]</span>
</span><span id="Spectra-380"><a href="#Spectra-380"><span class="linenos">380</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra-381"><a href="#Spectra-381"><span class="linenos">381</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Energy transfer / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;S(Q,E)&#39;</span><span class="p">]</span>
</span><span id="Spectra-382"><a href="#Spectra-382"><span class="linenos">382</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ATR&#39;</span><span class="p">:</span>
</span><span id="Spectra-383"><a href="#Spectra-383"><span class="linenos">383</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Wavenumber / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Absorbance&#39;</span><span class="p">]</span>
</span><span id="Spectra-384"><a href="#Spectra-384"><span class="linenos">384</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;RAMAN&#39;</span><span class="p">:</span>
</span><span id="Spectra-385"><a href="#Spectra-385"><span class="linenos">385</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Raman shift / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Counts&#39;</span><span class="p">]</span>
</span><span id="Spectra-386"><a href="#Spectra-386"><span class="linenos">386</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Spectra object. Used to load and process spectral data.</p>

<p><strong>Use example:</strong> to load two INS spectra CSV files from MANTID with cm$^{-1}$ as input units,
and plot them in meV units, normalizing their heights over the range from 20 to 50 meV:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">maat</span> <span class="k">as</span> <span class="nn">mt</span>
<span class="n">ins</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Spectra</span><span class="p">(</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;INS&#39;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;example_1.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;example_2.csv&#39;</span><span class="p">],</span>
    <span class="n">units_in</span><span class="o">=</span><span class="s1">&#39;cm-1&#39;</span><span class="p">,</span>
    <span class="n">units</span><span class="o">=</span><span class="s1">&#39;meV&#39;</span><span class="p">,</span>
    <span class="n">plotting</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Plotting</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Calculated INS&#39;</span><span class="p">,</span>
        <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="n">scale_range</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">ScaleRange</span><span class="p">(</span>
        <span class="n">xmin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">xmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="n">mt</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">spectra</span><span class="p">(</span><span class="n">ins</span><span class="p">)</span>
</code></pre>
</div>

<p>Check more use examples in the '/examples/' folder.</p>
</div>


                            <div id="Spectra.__init__" class="classattr">
                                        <input id="Spectra.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Spectra</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">save_as</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">filename</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">units</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">units_in</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">plotting</span><span class="p">:</span> <span class="n"><a href="#Plotting">Plotting</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#Plotting">Plotting</a></span> <span class="nb">object</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">scale_range</span><span class="p">:</span> <span class="n"><a href="#ScaleRange">ScaleRange</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#ScaleRange">ScaleRange</a></span> <span class="nb">object</span><span class="o">&gt;</span></span>)</span>

                <label class="view-source-button" for="Spectra.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectra.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectra.__init__-203"><a href="#Spectra.__init__-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Spectra.__init__-204"><a href="#Spectra.__init__-204"><span class="linenos">204</span></a>                 <span class="nb">type</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-205"><a href="#Spectra.__init__-205"><span class="linenos">205</span></a>                 <span class="n">comment</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-206"><a href="#Spectra.__init__-206"><span class="linenos">206</span></a>                 <span class="n">save_as</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-207"><a href="#Spectra.__init__-207"><span class="linenos">207</span></a>                 <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-208"><a href="#Spectra.__init__-208"><span class="linenos">208</span></a>                 <span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-209"><a href="#Spectra.__init__-209"><span class="linenos">209</span></a>                 <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-210"><a href="#Spectra.__init__-210"><span class="linenos">210</span></a>                 <span class="n">units_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.__init__-211"><a href="#Spectra.__init__-211"><span class="linenos">211</span></a>                 <span class="n">plotting</span><span class="p">:</span><span class="n">Plotting</span><span class="o">=</span><span class="n">Plotting</span><span class="p">(),</span>
</span><span id="Spectra.__init__-212"><a href="#Spectra.__init__-212"><span class="linenos">212</span></a>                 <span class="n">scale_range</span><span class="p">:</span><span class="n">ScaleRange</span><span class="o">=</span><span class="n">ScaleRange</span><span class="p">(),</span>
</span><span id="Spectra.__init__-213"><a href="#Spectra.__init__-213"><span class="linenos">213</span></a>                 <span class="p">):</span>
</span><span id="Spectra.__init__-214"><a href="#Spectra.__init__-214"><span class="linenos">214</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;All values can be set when initializing the Spectra object.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-215"><a href="#Spectra.__init__-215"><span class="linenos">215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.__init__-216"><a href="#Spectra.__init__-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Type of the spectra: `&#39;INS&#39;`, `&#39;ATR&#39;`, or `&#39;RAMAN&#39;`.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-217"><a href="#Spectra.__init__-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
</span><span id="Spectra.__init__-218"><a href="#Spectra.__init__-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Custom comment. If `Plotting.title` is None,  Title of the plot.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-219"><a href="#Spectra.__init__-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">save_as</span> <span class="o">=</span> <span class="n">save_as</span>
</span><span id="Spectra.__init__-220"><a href="#Spectra.__init__-220"><span class="linenos">220</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Filename to save the plot.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-221"><a href="#Spectra.__init__-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.__init__-222"><a href="#Spectra.__init__-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-223"><a href="#Spectra.__init__-223"><span class="linenos">223</span></a><span class="sd">        List containing the filenames with the spectral data.</span>
</span><span id="Spectra.__init__-224"><a href="#Spectra.__init__-224"><span class="linenos">224</span></a><span class="sd">        Loaded automatically with Pandas at initialization.</span>
</span><span id="Spectra.__init__-225"><a href="#Spectra.__init__-225"><span class="linenos">225</span></a><span class="sd">        In order for Pandas to read the files properly, note that the column lines must start by `#`.</span>
</span><span id="Spectra.__init__-226"><a href="#Spectra.__init__-226"><span class="linenos">226</span></a><span class="sd">        Any additional line that is not data must be removed or commented with `#`.</span>
</span><span id="Spectra.__init__-227"><a href="#Spectra.__init__-227"><span class="linenos">227</span></a><span class="sd">        CSV files must be formatted with the first column as the energy or energy transfer,</span>
</span><span id="Spectra.__init__-228"><a href="#Spectra.__init__-228"><span class="linenos">228</span></a><span class="sd">        and the second column with the intensity or absorbance, depending on the case. An additional third `&#39;Error&#39;` column can be used.</span>
</span><span id="Spectra.__init__-229"><a href="#Spectra.__init__-229"><span class="linenos">229</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-230"><a href="#Spectra.__init__-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.__init__-231"><a href="#Spectra.__init__-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-232"><a href="#Spectra.__init__-232"><span class="linenos">232</span></a><span class="sd">        List containing the pandas dataframes with the spectral data.</span>
</span><span id="Spectra.__init__-233"><a href="#Spectra.__init__-233"><span class="linenos">233</span></a><span class="sd">        Loaded automatically from the filenames at initialization.</span>
</span><span id="Spectra.__init__-234"><a href="#Spectra.__init__-234"><span class="linenos">234</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-235"><a href="#Spectra.__init__-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.__init__-236"><a href="#Spectra.__init__-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Target units of the spectral data. Can be `&#39;meV&#39;` or `&#39;cm-1&#39;`.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-237"><a href="#Spectra.__init__-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.__init__-238"><a href="#Spectra.__init__-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-239"><a href="#Spectra.__init__-239"><span class="linenos">239</span></a><span class="sd">        Input units of the spectral data, used in the input CSV files. Can be `&#39;meV&#39;` or `&#39;cm-1&#39;`.</span>
</span><span id="Spectra.__init__-240"><a href="#Spectra.__init__-240"><span class="linenos">240</span></a><span class="sd">        If the input CSV files have different units, it can also be set as a list, eg. `[&#39;meV&#39;, &#39;cm-1&#39;, &#39;cm-1&#39;]`.</span>
</span><span id="Spectra.__init__-241"><a href="#Spectra.__init__-241"><span class="linenos">241</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-242"><a href="#Spectra.__init__-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plotting</span> <span class="o">=</span> <span class="n">plotting</span>
</span><span id="Spectra.__init__-243"><a href="#Spectra.__init__-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;`Plotting` object, used to set the plotting options.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-244"><a href="#Spectra.__init__-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scale_range</span> <span class="o">=</span> <span class="n">scale_range</span>
</span><span id="Spectra.__init__-245"><a href="#Spectra.__init__-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;`ScaleRange` object, used to set the normalization parameters.&#39;&#39;&#39;</span>
</span><span id="Spectra.__init__-246"><a href="#Spectra.__init__-246"><span class="linenos">246</span></a>
</span><span id="Spectra.__init__-247"><a href="#Spectra.__init__-247"><span class="linenos">247</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_type</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
</span><span id="Spectra.__init__-248"><a href="#Spectra.__init__-248"><span class="linenos">248</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_dataframe</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">)</span>
</span><span id="Spectra.__init__-249"><a href="#Spectra.__init__-249"><span class="linenos">249</span></a>        <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_units</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">units_in</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>All values can be set when initializing the Spectra object.</p>
</div>


                            </div>
                            <div id="Spectra.type" class="classattr">
                                <div class="attr variable">
            <span class="name">type</span>

        
    </div>
    <a class="headerlink" href="#Spectra.type"></a>
    
            <div class="docstring"><p>Type of the spectra: <code>'INS'</code>, <code>'ATR'</code>, or <code>'RAMAN'</code>.</p>
</div>


                            </div>
                            <div id="Spectra.comment" class="classattr">
                                <div class="attr variable">
            <span class="name">comment</span>

        
    </div>
    <a class="headerlink" href="#Spectra.comment"></a>
    
            <div class="docstring"><p>Custom comment. If <code><a href="#Plotting.title">Plotting.title</a></code> is None,  Title of the plot.</p>
</div>


                            </div>
                            <div id="Spectra.save_as" class="classattr">
                                <div class="attr variable">
            <span class="name">save_as</span>

        
    </div>
    <a class="headerlink" href="#Spectra.save_as"></a>
    
            <div class="docstring"><p>Filename to save the plot.</p>
</div>


                            </div>
                            <div id="Spectra.filename" class="classattr">
                                <div class="attr variable">
            <span class="name">filename</span>

        
    </div>
    <a class="headerlink" href="#Spectra.filename"></a>
    
            <div class="docstring"><p>List containing the filenames with the spectral data.
Loaded automatically with Pandas at initialization.
In order for Pandas to read the files properly, note that the column lines must start by <code>#</code>.
Any additional line that is not data must be removed or commented with <code>#</code>.
CSV files must be formatted with the first column as the energy or energy transfer,
and the second column with the intensity or absorbance, depending on the case. An additional third <code>'Error'</code> column can be used.</p>
</div>


                            </div>
                            <div id="Spectra.dataframe" class="classattr">
                                <div class="attr variable">
            <span class="name">dataframe</span>

        
    </div>
    <a class="headerlink" href="#Spectra.dataframe"></a>
    
            <div class="docstring"><p>List containing the pandas dataframes with the spectral data.
Loaded automatically from the filenames at initialization.</p>
</div>


                            </div>
                            <div id="Spectra.units" class="classattr">
                                <div class="attr variable">
            <span class="name">units</span>

        
    </div>
    <a class="headerlink" href="#Spectra.units"></a>
    
            <div class="docstring"><p>Target units of the spectral data. Can be <code>'meV'</code> or <code>'cm-1'</code>.</p>
</div>


                            </div>
                            <div id="Spectra.units_in" class="classattr">
                                <div class="attr variable">
            <span class="name">units_in</span>

        
    </div>
    <a class="headerlink" href="#Spectra.units_in"></a>
    
            <div class="docstring"><p>Input units of the spectral data, used in the input CSV files. Can be <code>'meV'</code> or <code>'cm-1'</code>.
If the input CSV files have different units, it can also be set as a list, eg. <code>['meV', 'cm-1', 'cm-1']</code>.</p>
</div>


                            </div>
                            <div id="Spectra.plotting" class="classattr">
                                <div class="attr variable">
            <span class="name">plotting</span>

        
    </div>
    <a class="headerlink" href="#Spectra.plotting"></a>
    
            <div class="docstring"><p><code><a href="#Plotting">Plotting</a></code> object, used to set the plotting options.</p>
</div>


                            </div>
                            <div id="Spectra.scale_range" class="classattr">
                                <div class="attr variable">
            <span class="name">scale_range</span>

        
    </div>
    <a class="headerlink" href="#Spectra.scale_range"></a>
    
            <div class="docstring"><p><code><a href="#ScaleRange">ScaleRange</a></code> object, used to set the normalization parameters.</p>
</div>


                            </div>
                            <div id="Spectra.set_units" class="classattr">
                                        <input id="Spectra.set_units-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_units</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">units</span>, </span><span class="param"><span class="n">units_in</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">default_unit</span><span class="o">=</span><span class="s1">&#39;cm-1&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Spectra.set_units-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Spectra.set_units"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Spectra.set_units-291"><a href="#Spectra.set_units-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">set_units</span><span class="p">(</span>
</span><span id="Spectra.set_units-292"><a href="#Spectra.set_units-292"><span class="linenos">292</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="Spectra.set_units-293"><a href="#Spectra.set_units-293"><span class="linenos">293</span></a>            <span class="n">units</span><span class="p">,</span>
</span><span id="Spectra.set_units-294"><a href="#Spectra.set_units-294"><span class="linenos">294</span></a>            <span class="n">units_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Spectra.set_units-295"><a href="#Spectra.set_units-295"><span class="linenos">295</span></a>            <span class="n">default_unit</span><span class="o">=</span><span class="s1">&#39;cm-1&#39;</span><span class="p">,</span>
</span><span id="Spectra.set_units-296"><a href="#Spectra.set_units-296"><span class="linenos">296</span></a>            <span class="p">):</span>
</span><span id="Spectra.set_units-297"><a href="#Spectra.set_units-297"><span class="linenos">297</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Spectra.set_units-298"><a href="#Spectra.set_units-298"><span class="linenos">298</span></a><span class="sd">        Method to change between spectral units. ALWAYS use this method to do that.</span>
</span><span id="Spectra.set_units-299"><a href="#Spectra.set_units-299"><span class="linenos">299</span></a><span class="sd">        For example, to change from cm-1 to meV:</span>
</span><span id="Spectra.set_units-300"><a href="#Spectra.set_units-300"><span class="linenos">300</span></a><span class="sd">        ```python</span>
</span><span id="Spectra.set_units-301"><a href="#Spectra.set_units-301"><span class="linenos">301</span></a><span class="sd">        Spectra.set_units(&#39;meV&#39;, &#39;cm-1&#39;)</span>
</span><span id="Spectra.set_units-302"><a href="#Spectra.set_units-302"><span class="linenos">302</span></a><span class="sd">        ```</span>
</span><span id="Spectra.set_units-303"><a href="#Spectra.set_units-303"><span class="linenos">303</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Spectra.set_units-304"><a href="#Spectra.set_units-304"><span class="linenos">304</span></a>        <span class="n">mev</span> <span class="o">=</span> <span class="s1">&#39;meV&#39;</span>
</span><span id="Spectra.set_units-305"><a href="#Spectra.set_units-305"><span class="linenos">305</span></a>        <span class="n">cm</span> <span class="o">=</span> <span class="s1">&#39;cm-1&#39;</span>
</span><span id="Spectra.set_units-306"><a href="#Spectra.set_units-306"><span class="linenos">306</span></a>        <span class="n">unit_format</span><span class="o">=</span><span class="p">{</span>
</span><span id="Spectra.set_units-307"><a href="#Spectra.set_units-307"><span class="linenos">307</span></a>                <span class="n">mev</span><span class="p">:</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;meV&#39;</span><span class="p">],</span>
</span><span id="Spectra.set_units-308"><a href="#Spectra.set_units-308"><span class="linenos">308</span></a>                <span class="n">cm</span><span class="p">:</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;cm-1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">unit_keys</span><span class="p">[</span><span class="s1">&#39;cm&#39;</span><span class="p">],</span>
</span><span id="Spectra.set_units-309"><a href="#Spectra.set_units-309"><span class="linenos">309</span></a>            <span class="p">}</span>
</span><span id="Spectra.set_units-310"><a href="#Spectra.set_units-310"><span class="linenos">310</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra.set_units-311"><a href="#Spectra.set_units-311"><span class="linenos">311</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
</span><span id="Spectra.set_units-312"><a href="#Spectra.set_units-312"><span class="linenos">312</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
</span><span id="Spectra.set_units-313"><a href="#Spectra.set_units-313"><span class="linenos">313</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra.set_units-314"><a href="#Spectra.set_units-314"><span class="linenos">314</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="n">units_in</span>
</span><span id="Spectra.set_units-315"><a href="#Spectra.set_units-315"><span class="linenos">315</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
</span><span id="Spectra.set_units-316"><a href="#Spectra.set_units-316"><span class="linenos">316</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra.set_units-317"><a href="#Spectra.set_units-317"><span class="linenos">317</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.set_units-318"><a href="#Spectra.set_units-318"><span class="linenos">318</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">default_unit</span>
</span><span id="Spectra.set_units-319"><a href="#Spectra.set_units-319"><span class="linenos">319</span></a>        <span class="k">elif</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra.set_units-320"><a href="#Spectra.set_units-320"><span class="linenos">320</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.set_units-321"><a href="#Spectra.set_units-321"><span class="linenos">321</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span>
</span><span id="Spectra.set_units-322"><a href="#Spectra.set_units-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units_in</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Spectra.set_units-323"><a href="#Spectra.set_units-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit_in</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">units_in</span><span class="p">):</span>
</span><span id="Spectra.set_units-324"><a href="#Spectra.set_units-324"><span class="linenos">324</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra.set_units-325"><a href="#Spectra.set_units-325"><span class="linenos">325</span></a>                    <span class="k">if</span> <span class="n">unit_in</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra.set_units-326"><a href="#Spectra.set_units-326"><span class="linenos">326</span></a>                        <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra.set_units-327"><a href="#Spectra.set_units-327"><span class="linenos">327</span></a>                        <span class="k">break</span>
</span><span id="Spectra.set_units-328"><a href="#Spectra.set_units-328"><span class="linenos">328</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectra.set_units-329"><a href="#Spectra.set_units-329"><span class="linenos">329</span></a>                <span class="n">units_in</span> <span class="o">=</span> <span class="n">units_in</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra.set_units-330"><a href="#Spectra.set_units-330"><span class="linenos">330</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
</span><span id="Spectra.set_units-331"><a href="#Spectra.set_units-331"><span class="linenos">331</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;units_in must be a list of the same length as filenames.&quot;</span><span class="p">)</span>
</span><span id="Spectra.set_units-332"><a href="#Spectra.set_units-332"><span class="linenos">332</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">units_in</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectra.set_units-333"><a href="#Spectra.set_units-333"><span class="linenos">333</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra.set_units-334"><a href="#Spectra.set_units-334"><span class="linenos">334</span></a>                <span class="k">if</span> <span class="n">units_in</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra.set_units-335"><a href="#Spectra.set_units-335"><span class="linenos">335</span></a>                    <span class="n">units_in</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra.set_units-336"><a href="#Spectra.set_units-336"><span class="linenos">336</span></a>                    <span class="k">break</span>
</span><span id="Spectra.set_units-337"><a href="#Spectra.set_units-337"><span class="linenos">337</span></a>            <span class="n">units_in</span> <span class="o">=</span> <span class="p">[</span><span class="n">units_in</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra.set_units-338"><a href="#Spectra.set_units-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Spectra.set_units-339"><a href="#Spectra.set_units-339"><span class="linenos">339</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
</span><span id="Spectra.set_units-340"><a href="#Spectra.set_units-340"><span class="linenos">340</span></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra.set_units-341"><a href="#Spectra.set_units-341"><span class="linenos">341</span></a>                    <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra.set_units-342"><a href="#Spectra.set_units-342"><span class="linenos">342</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra.set_units-343"><a href="#Spectra.set_units-343"><span class="linenos">343</span></a>                        <span class="k">break</span>
</span><span id="Spectra.set_units-344"><a href="#Spectra.set_units-344"><span class="linenos">344</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Spectra.set_units-345"><a href="#Spectra.set_units-345"><span class="linenos">345</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra.set_units-346"><a href="#Spectra.set_units-346"><span class="linenos">346</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">):</span>
</span><span id="Spectra.set_units-347"><a href="#Spectra.set_units-347"><span class="linenos">347</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;units_in must be a list of the same length as filenames.&quot;</span><span class="p">)</span>
</span><span id="Spectra.set_units-348"><a href="#Spectra.set_units-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Spectra.set_units-349"><a href="#Spectra.set_units-349"><span class="linenos">349</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unit_format</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Spectra.set_units-350"><a href="#Spectra.set_units-350"><span class="linenos">350</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
</span><span id="Spectra.set_units-351"><a href="#Spectra.set_units-351"><span class="linenos">351</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Spectra.set_units-352"><a href="#Spectra.set_units-352"><span class="linenos">352</span></a>                    <span class="k">break</span>
</span><span id="Spectra.set_units-353"><a href="#Spectra.set_units-353"><span class="linenos">353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Spectra.set_units-354"><a href="#Spectra.set_units-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="n">units_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Spectra.set_units-355"><a href="#Spectra.set_units-355"><span class="linenos">355</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Spectra.set_units-356"><a href="#Spectra.set_units-356"><span class="linenos">356</span></a>        <span class="c1"># Otherwise, convert the dataframes</span>
</span><span id="Spectra.set_units-357"><a href="#Spectra.set_units-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">units_in</span><span class="p">):</span>
</span><span id="Spectra.set_units-358"><a href="#Spectra.set_units-358"><span class="linenos">358</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Units len mismatching.&quot;</span><span class="p">)</span>
</span><span id="Spectra.set_units-359"><a href="#Spectra.set_units-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">unit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
</span><span id="Spectra.set_units-360"><a href="#Spectra.set_units-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="Spectra.set_units-361"><a href="#Spectra.set_units-361"><span class="linenos">361</span></a>                <span class="k">continue</span>
</span><span id="Spectra.set_units-362"><a href="#Spectra.set_units-362"><span class="linenos">362</span></a>            <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">mev</span> <span class="ow">and</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="p">:</span>
</span><span id="Spectra.set_units-363"><a href="#Spectra.set_units-363"><span class="linenos">363</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">cm_to_meV</span>
</span><span id="Spectra.set_units-364"><a href="#Spectra.set_units-364"><span class="linenos">364</span></a>            <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">cm</span> <span class="ow">and</span> <span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mev</span><span class="p">:</span>
</span><span id="Spectra.set_units-365"><a href="#Spectra.set_units-365"><span class="linenos">365</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">meV_to_cm</span>
</span><span id="Spectra.set_units-366"><a href="#Spectra.set_units-366"><span class="linenos">366</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra.set_units-367"><a href="#Spectra.set_units-367"><span class="linenos">367</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unit conversion error between &#39;</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&#39; and &#39;</span><span class="si">{</span><span class="n">units_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="Spectra.set_units-368"><a href="#Spectra.set_units-368"><span class="linenos">368</span></a>        <span class="c1"># Rename dataframe columns</span>
</span><span id="Spectra.set_units-369"><a href="#Spectra.set_units-369"><span class="linenos">369</span></a>        <span class="n">E_units</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Spectra.set_units-370"><a href="#Spectra.set_units-370"><span class="linenos">370</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">):</span>
</span><span id="Spectra.set_units-371"><a href="#Spectra.set_units-371"><span class="linenos">371</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mev</span><span class="p">:</span>
</span><span id="Spectra.set_units-372"><a href="#Spectra.set_units-372"><span class="linenos">372</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="s1">&#39;meV&#39;</span>
</span><span id="Spectra.set_units-373"><a href="#Spectra.set_units-373"><span class="linenos">373</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">cm</span><span class="p">:</span>
</span><span id="Spectra.set_units-374"><a href="#Spectra.set_units-374"><span class="linenos">374</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="s1">&#39;cm-1&#39;</span>
</span><span id="Spectra.set_units-375"><a href="#Spectra.set_units-375"><span class="linenos">375</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra.set_units-376"><a href="#Spectra.set_units-376"><span class="linenos">376</span></a>                <span class="n">E_units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="Spectra.set_units-377"><a href="#Spectra.set_units-377"><span class="linenos">377</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;INS&#39;</span><span class="p">:</span>
</span><span id="Spectra.set_units-378"><a href="#Spectra.set_units-378"><span class="linenos">378</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="Spectra.set_units-379"><a href="#Spectra.set_units-379"><span class="linenos">379</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Energy transfer / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;S(Q,E)&#39;</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">]</span>
</span><span id="Spectra.set_units-380"><a href="#Spectra.set_units-380"><span class="linenos">380</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Spectra.set_units-381"><a href="#Spectra.set_units-381"><span class="linenos">381</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Energy transfer / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;S(Q,E)&#39;</span><span class="p">]</span>
</span><span id="Spectra.set_units-382"><a href="#Spectra.set_units-382"><span class="linenos">382</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;ATR&#39;</span><span class="p">:</span>
</span><span id="Spectra.set_units-383"><a href="#Spectra.set_units-383"><span class="linenos">383</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Wavenumber / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Absorbance&#39;</span><span class="p">]</span>
</span><span id="Spectra.set_units-384"><a href="#Spectra.set_units-384"><span class="linenos">384</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;RAMAN&#39;</span><span class="p">:</span>
</span><span id="Spectra.set_units-385"><a href="#Spectra.set_units-385"><span class="linenos">385</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Raman shift / </span><span class="si">{</span><span class="n">E_units</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Counts&#39;</span><span class="p">]</span>
</span><span id="Spectra.set_units-386"><a href="#Spectra.set_units-386"><span class="linenos">386</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Method to change between spectral units. ALWAYS use this method to do that.
For example, to change from cm-1 to meV:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n"><a href="#Spectra.set_units">Spectra.set_units</a></span><span class="p">(</span><span class="s1">&#39;meV&#39;</span><span class="p">,</span> <span class="s1">&#39;cm-1&#39;</span><span class="p">)</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
                <section id="Material">
                            <input id="Material-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Material</span>:

                <label class="view-source-button" for="Material-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Material"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Material-389"><a href="#Material-389"><span class="linenos">389</span></a><span class="k">class</span> <span class="nc">Material</span><span class="p">:</span>
</span><span id="Material-390"><a href="#Material-390"><span class="linenos">390</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Material-391"><a href="#Material-391"><span class="linenos">391</span></a><span class="sd">    Material class.</span>
</span><span id="Material-392"><a href="#Material-392"><span class="linenos">392</span></a><span class="sd">    Used to calculate molar masses and cross sections,</span>
</span><span id="Material-393"><a href="#Material-393"><span class="linenos">393</span></a><span class="sd">    and to pass data to different analysis functions such as `Maat.deuteration.impulse_approx().`</span>
</span><span id="Material-394"><a href="#Material-394"><span class="linenos">394</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="Material-395"><a href="#Material-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Material-396"><a href="#Material-396"><span class="linenos">396</span></a>                 <span class="n">atoms</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span>
</span><span id="Material-397"><a href="#Material-397"><span class="linenos">397</span></a>                 <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-398"><a href="#Material-398"><span class="linenos">398</span></a>                 <span class="n">grams</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-399"><a href="#Material-399"><span class="linenos">399</span></a>                 <span class="n">grams_error</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-400"><a href="#Material-400"><span class="linenos">400</span></a>                 <span class="n">mols</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-401"><a href="#Material-401"><span class="linenos">401</span></a>                 <span class="n">mols_error</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-402"><a href="#Material-402"><span class="linenos">402</span></a>                 <span class="n">molar_mass</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-403"><a href="#Material-403"><span class="linenos">403</span></a>                 <span class="n">cross_section</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material-404"><a href="#Material-404"><span class="linenos">404</span></a>                 <span class="p">):</span>
</span><span id="Material-405"><a href="#Material-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Material-406"><a href="#Material-406"><span class="linenos">406</span></a><span class="sd">        All values can be set when initializing the Material object. However, it is recommended</span>
</span><span id="Material-407"><a href="#Material-407"><span class="linenos">407</span></a><span class="sd">        to only set the atoms and the grams (and the name), and calculate the rest with `Material.set()`.</span>
</span><span id="Material-408"><a href="#Material-408"><span class="linenos">408</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Material-409"><a href="#Material-409"><span class="linenos">409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
</span><span id="Material-410"><a href="#Material-410"><span class="linenos">410</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Dict of atoms in the material.&#39;&#39;&#39;</span>
</span><span id="Material-411"><a href="#Material-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Material-412"><a href="#Material-412"><span class="linenos">412</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Name of the material.&#39;&#39;&#39;</span>
</span><span id="Material-413"><a href="#Material-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="o">=</span> <span class="n">grams</span>
</span><span id="Material-414"><a href="#Material-414"><span class="linenos">414</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Mass, in grams.&#39;&#39;&#39;</span>
</span><span id="Material-415"><a href="#Material-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">=</span> <span class="n">grams_error</span>
</span><span id="Material-416"><a href="#Material-416"><span class="linenos">416</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Error of the measured mass in grams. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material-417"><a href="#Material-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span>
</span><span id="Material-418"><a href="#Material-418"><span class="linenos">418</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Number of moles. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material-419"><a href="#Material-419"><span class="linenos">419</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="o">=</span> <span class="n">mols_error</span>
</span><span id="Material-420"><a href="#Material-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Error of the number of moles. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material-421"><a href="#Material-421"><span class="linenos">421</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">molar_mass</span>
</span><span id="Material-422"><a href="#Material-422"><span class="linenos">422</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Molar mass of the material, in mol/g. Calculated automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material-423"><a href="#Material-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="o">=</span> <span class="n">cross_section</span>
</span><span id="Material-424"><a href="#Material-424"><span class="linenos">424</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Cross section of the material, in barns. Calculated automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material-425"><a href="#Material-425"><span class="linenos">425</span></a>
</span><span id="Material-426"><a href="#Material-426"><span class="linenos">426</span></a>    <span class="k">def</span> <span class="nf">_set_grams_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material-427"><a href="#Material-427"><span class="linenos">427</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the error in grams, based on the number of decimal places.&#39;&#39;&#39;</span>
</span><span id="Material-428"><a href="#Material-428"><span class="linenos">428</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-429"><a href="#Material-429"><span class="linenos">429</span></a>            <span class="k">return</span>
</span><span id="Material-430"><a href="#Material-430"><span class="linenos">430</span></a>        <span class="n">decimal_accuracy</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Material-431"><a href="#Material-431"><span class="linenos">431</span></a>        <span class="c1"># Calculate the error in grams</span>
</span><span id="Material-432"><a href="#Material-432"><span class="linenos">432</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">decimal_accuracy</span><span class="p">)</span>
</span><span id="Material-433"><a href="#Material-433"><span class="linenos">433</span></a>
</span><span id="Material-434"><a href="#Material-434"><span class="linenos">434</span></a>    <span class="k">def</span> <span class="nf">_set_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material-435"><a href="#Material-435"><span class="linenos">435</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the molar mass of the material.\n</span>
</span><span id="Material-436"><a href="#Material-436"><span class="linenos">436</span></a><span class="sd">        If `self.grams` is not `None`, the number of moles will be calculated and overwritten.&#39;&#39;&#39;</span>
</span><span id="Material-437"><a href="#Material-437"><span class="linenos">437</span></a>        <span class="n">material_grams_per_mol</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Material-438"><a href="#Material-438"><span class="linenos">438</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="Material-439"><a href="#Material-439"><span class="linenos">439</span></a>            <span class="n">material_grams_per_mol</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="Material-440"><a href="#Material-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">material_grams_per_mol</span>
</span><span id="Material-441"><a href="#Material-441"><span class="linenos">441</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-442"><a href="#Material-442"><span class="linenos">442</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_grams_error</span><span class="p">()</span>
</span><span id="Material-443"><a href="#Material-443"><span class="linenos">443</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="o">/</span> <span class="n">material_grams_per_mol</span>
</span><span id="Material-444"><a href="#Material-444"><span class="linenos">444</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Material-445"><a href="#Material-445"><span class="linenos">445</span></a>    
</span><span id="Material-446"><a href="#Material-446"><span class="linenos">446</span></a>    <span class="k">def</span> <span class="nf">_set_cross_section</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material-447"><a href="#Material-447"><span class="linenos">447</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the cross section of the material, based on the atoms dict.&#39;&#39;&#39;</span>
</span><span id="Material-448"><a href="#Material-448"><span class="linenos">448</span></a>        <span class="n">total_cross_section</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="Material-449"><a href="#Material-449"><span class="linenos">449</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
</span><span id="Material-450"><a href="#Material-450"><span class="linenos">450</span></a>            <span class="n">total_cross_section</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">*</span> <span class="n">cross_section</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="Material-451"><a href="#Material-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="o">=</span> <span class="n">total_cross_section</span>
</span><span id="Material-452"><a href="#Material-452"><span class="linenos">452</span></a>
</span><span id="Material-453"><a href="#Material-453"><span class="linenos">453</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material-454"><a href="#Material-454"><span class="linenos">454</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the molar mass, cross section and errors of the material.&#39;&#39;&#39;</span>
</span><span id="Material-455"><a href="#Material-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_mass</span><span class="p">()</span>
</span><span id="Material-456"><a href="#Material-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cross_section</span><span class="p">()</span>
</span><span id="Material-457"><a href="#Material-457"><span class="linenos">457</span></a>
</span><span id="Material-458"><a href="#Material-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material-459"><a href="#Material-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Print a summary with the material information.&#39;&#39;&#39;</span>
</span><span id="Material-460"><a href="#Material-460"><span class="linenos">460</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">MATERIAL&#39;</span><span class="p">)</span>
</span><span id="Material-461"><a href="#Material-461"><span class="linenos">461</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-462"><a href="#Material-462"><span class="linenos">462</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Material-463"><a href="#Material-463"><span class="linenos">463</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-464"><a href="#Material-464"><span class="linenos">464</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Grams: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="si">}</span><span class="s1"> +- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span><span class="si">}</span><span class="s1"> g&#39;</span><span class="p">)</span>
</span><span id="Material-465"><a href="#Material-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-466"><a href="#Material-466"><span class="linenos">466</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Grams: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="si">}</span><span class="s1"> g&#39;</span><span class="p">)</span>
</span><span id="Material-467"><a href="#Material-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-468"><a href="#Material-468"><span class="linenos">468</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="si">}</span><span class="s1"> +- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span><span class="si">}</span><span class="s1"> mol&#39;</span><span class="p">)</span>
</span><span id="Material-469"><a href="#Material-469"><span class="linenos">469</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-470"><a href="#Material-470"><span class="linenos">470</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="si">}</span><span class="s1"> mol&#39;</span><span class="p">)</span>
</span><span id="Material-471"><a href="#Material-471"><span class="linenos">471</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-472"><a href="#Material-472"><span class="linenos">472</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Molar mass: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span><span class="si">}</span><span class="s1"> g/mol&#39;</span><span class="p">)</span>
</span><span id="Material-473"><a href="#Material-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-474"><a href="#Material-474"><span class="linenos">474</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross section: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span><span class="si">}</span><span class="s1"> barns&#39;</span><span class="p">)</span>
</span><span id="Material-475"><a href="#Material-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material-476"><a href="#Material-476"><span class="linenos">476</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Material-477"><a href="#Material-477"><span class="linenos">477</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Material class.
Used to calculate molar masses and cross sections,
and to pass data to different analysis functions such as <code>Maat.deuteration.impulse_approx().</code></p>
</div>


                            <div id="Material.__init__" class="classattr">
                                        <input id="Material.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Material</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">atoms</span><span class="p">:</span> <span class="nb">dict</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">grams</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">grams_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mols</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mols_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">molar_mass</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">cross_section</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Material.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Material.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Material.__init__-395"><a href="#Material.__init__-395"><span class="linenos">395</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Material.__init__-396"><a href="#Material.__init__-396"><span class="linenos">396</span></a>                 <span class="n">atoms</span><span class="p">:</span><span class="nb">dict</span><span class="p">,</span>
</span><span id="Material.__init__-397"><a href="#Material.__init__-397"><span class="linenos">397</span></a>                 <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-398"><a href="#Material.__init__-398"><span class="linenos">398</span></a>                 <span class="n">grams</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-399"><a href="#Material.__init__-399"><span class="linenos">399</span></a>                 <span class="n">grams_error</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-400"><a href="#Material.__init__-400"><span class="linenos">400</span></a>                 <span class="n">mols</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-401"><a href="#Material.__init__-401"><span class="linenos">401</span></a>                 <span class="n">mols_error</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-402"><a href="#Material.__init__-402"><span class="linenos">402</span></a>                 <span class="n">molar_mass</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-403"><a href="#Material.__init__-403"><span class="linenos">403</span></a>                 <span class="n">cross_section</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Material.__init__-404"><a href="#Material.__init__-404"><span class="linenos">404</span></a>                 <span class="p">):</span>
</span><span id="Material.__init__-405"><a href="#Material.__init__-405"><span class="linenos">405</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="Material.__init__-406"><a href="#Material.__init__-406"><span class="linenos">406</span></a><span class="sd">        All values can be set when initializing the Material object. However, it is recommended</span>
</span><span id="Material.__init__-407"><a href="#Material.__init__-407"><span class="linenos">407</span></a><span class="sd">        to only set the atoms and the grams (and the name), and calculate the rest with `Material.set()`.</span>
</span><span id="Material.__init__-408"><a href="#Material.__init__-408"><span class="linenos">408</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="Material.__init__-409"><a href="#Material.__init__-409"><span class="linenos">409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
</span><span id="Material.__init__-410"><a href="#Material.__init__-410"><span class="linenos">410</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Dict of atoms in the material.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-411"><a href="#Material.__init__-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span><span id="Material.__init__-412"><a href="#Material.__init__-412"><span class="linenos">412</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Name of the material.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-413"><a href="#Material.__init__-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="o">=</span> <span class="n">grams</span>
</span><span id="Material.__init__-414"><a href="#Material.__init__-414"><span class="linenos">414</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Mass, in grams.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-415"><a href="#Material.__init__-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="o">=</span> <span class="n">grams_error</span>
</span><span id="Material.__init__-416"><a href="#Material.__init__-416"><span class="linenos">416</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Error of the measured mass in grams. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-417"><a href="#Material.__init__-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span>
</span><span id="Material.__init__-418"><a href="#Material.__init__-418"><span class="linenos">418</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Number of moles. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-419"><a href="#Material.__init__-419"><span class="linenos">419</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="o">=</span> <span class="n">mols_error</span>
</span><span id="Material.__init__-420"><a href="#Material.__init__-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Error of the number of moles. Set automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-421"><a href="#Material.__init__-421"><span class="linenos">421</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="o">=</span> <span class="n">molar_mass</span>
</span><span id="Material.__init__-422"><a href="#Material.__init__-422"><span class="linenos">422</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Molar mass of the material, in mol/g. Calculated automatically with `self.set()`.&#39;&#39;&#39;</span>
</span><span id="Material.__init__-423"><a href="#Material.__init__-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="o">=</span> <span class="n">cross_section</span>
</span><span id="Material.__init__-424"><a href="#Material.__init__-424"><span class="linenos">424</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Cross section of the material, in barns. Calculated automatically with `self.set()`.&#39;&#39;&#39;</span>
</span></pre></div>


            <div class="docstring"><p>All values can be set when initializing the Material object. However, it is recommended
to only set the atoms and the grams (and the name), and calculate the rest with <code><a href="#Material.set">Material.set()</a></code>.</p>
</div>


                            </div>
                            <div id="Material.atoms" class="classattr">
                                <div class="attr variable">
            <span class="name">atoms</span>

        
    </div>
    <a class="headerlink" href="#Material.atoms"></a>
    
            <div class="docstring"><p>Dict of atoms in the material.</p>
</div>


                            </div>
                            <div id="Material.name" class="classattr">
                                <div class="attr variable">
            <span class="name">name</span>

        
    </div>
    <a class="headerlink" href="#Material.name"></a>
    
            <div class="docstring"><p>Name of the material.</p>
</div>


                            </div>
                            <div id="Material.grams" class="classattr">
                                <div class="attr variable">
            <span class="name">grams</span>

        
    </div>
    <a class="headerlink" href="#Material.grams"></a>
    
            <div class="docstring"><p>Mass, in grams.</p>
</div>


                            </div>
                            <div id="Material.grams_error" class="classattr">
                                <div class="attr variable">
            <span class="name">grams_error</span>

        
    </div>
    <a class="headerlink" href="#Material.grams_error"></a>
    
            <div class="docstring"><p>Error of the measured mass in grams. Set automatically with <code>self.set()</code>.</p>
</div>


                            </div>
                            <div id="Material.mols" class="classattr">
                                <div class="attr variable">
            <span class="name">mols</span>

        
    </div>
    <a class="headerlink" href="#Material.mols"></a>
    
            <div class="docstring"><p>Number of moles. Set automatically with <code>self.set()</code>.</p>
</div>


                            </div>
                            <div id="Material.mols_error" class="classattr">
                                <div class="attr variable">
            <span class="name">mols_error</span>

        
    </div>
    <a class="headerlink" href="#Material.mols_error"></a>
    
            <div class="docstring"><p>Error of the number of moles. Set automatically with <code>self.set()</code>.</p>
</div>


                            </div>
                            <div id="Material.molar_mass" class="classattr">
                                <div class="attr variable">
            <span class="name">molar_mass</span>

        
    </div>
    <a class="headerlink" href="#Material.molar_mass"></a>
    
            <div class="docstring"><p>Molar mass of the material, in mol/g. Calculated automatically with <code>self.set()</code>.</p>
</div>


                            </div>
                            <div id="Material.cross_section" class="classattr">
                                <div class="attr variable">
            <span class="name">cross_section</span>

        
    </div>
    <a class="headerlink" href="#Material.cross_section"></a>
    
            <div class="docstring"><p>Cross section of the material, in barns. Calculated automatically with <code>self.set()</code>.</p>
</div>


                            </div>
                            <div id="Material.set" class="classattr">
                                        <input id="Material.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Material.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Material.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Material.set-453"><a href="#Material.set-453"><span class="linenos">453</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material.set-454"><a href="#Material.set-454"><span class="linenos">454</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Set the molar mass, cross section and errors of the material.&#39;&#39;&#39;</span>
</span><span id="Material.set-455"><a href="#Material.set-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_mass</span><span class="p">()</span>
</span><span id="Material.set-456"><a href="#Material.set-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_cross_section</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Set the molar mass, cross section and errors of the material.</p>
</div>


                            </div>
                            <div id="Material.print" class="classattr">
                                        <input id="Material.print-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">print</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Material.print-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Material.print"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Material.print-458"><a href="#Material.print-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Material.print-459"><a href="#Material.print-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Print a summary with the material information.&#39;&#39;&#39;</span>
</span><span id="Material.print-460"><a href="#Material.print-460"><span class="linenos">460</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">MATERIAL&#39;</span><span class="p">)</span>
</span><span id="Material.print-461"><a href="#Material.print-461"><span class="linenos">461</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-462"><a href="#Material.print-462"><span class="linenos">462</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Material.print-463"><a href="#Material.print-463"><span class="linenos">463</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-464"><a href="#Material.print-464"><span class="linenos">464</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Grams: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="si">}</span><span class="s1"> +- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams_error</span><span class="si">}</span><span class="s1"> g&#39;</span><span class="p">)</span>
</span><span id="Material.print-465"><a href="#Material.print-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">grams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-466"><a href="#Material.print-466"><span class="linenos">466</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Grams: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">grams</span><span class="si">}</span><span class="s1"> g&#39;</span><span class="p">)</span>
</span><span id="Material.print-467"><a href="#Material.print-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-468"><a href="#Material.print-468"><span class="linenos">468</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="si">}</span><span class="s1"> +- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols_error</span><span class="si">}</span><span class="s1"> mol&#39;</span><span class="p">)</span>
</span><span id="Material.print-469"><a href="#Material.print-469"><span class="linenos">469</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-470"><a href="#Material.print-470"><span class="linenos">470</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Moles: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="si">}</span><span class="s1"> mol&#39;</span><span class="p">)</span>
</span><span id="Material.print-471"><a href="#Material.print-471"><span class="linenos">471</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-472"><a href="#Material.print-472"><span class="linenos">472</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Molar mass: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_mass</span><span class="si">}</span><span class="s1"> g/mol&#39;</span><span class="p">)</span>
</span><span id="Material.print-473"><a href="#Material.print-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-474"><a href="#Material.print-474"><span class="linenos">474</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross section: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span><span class="si">}</span><span class="s1"> barns&#39;</span><span class="p">)</span>
</span><span id="Material.print-475"><a href="#Material.print-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Material.print-476"><a href="#Material.print-476"><span class="linenos">476</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Atoms: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Material.print-477"><a href="#Material.print-477"><span class="linenos">477</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Print a summary with the material information.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>